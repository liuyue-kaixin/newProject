{"version":3,"sources":["file:///Volumes/%E5%9B%BA%E6%80%81/ccProject/extensions/oops-plugin-framework/assets/module/config/GameQueryConfig.ts"],"names":["GameQueryConfig","sys","oops","StringUtil","debug","_data","username","lang","data","constructor","isBrowser","parseUrl","guid","log","logConfig","window","document","url","location","href","toString","u","split","get","i","l","length","j","x","indexOf","key","substring","value","decodeURIComponent"],"mappings":";;;sGAeaA,e;;;;;;;;;;;;;;;;;;;AATJC,MAAAA,G,OAAAA,G;;AACAC,MAAAA,I,iBAAAA,I;;AACAC,MAAAA,U,iBAAAA,U;;;;;;AART;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;iCACaH,e,GAAN,MAAMA,eAAN,CAAsB;AACzB;AACgB,YAALI,KAAK,GAAW;AACvB,iBAAO,KAAKC,KAAL,CAAW,OAAX,CAAP;AACH;AAED;;;AACmB,YAARC,QAAQ,GAAW;AAC1B,iBAAO,KAAKD,KAAL,CAAW,UAAX,CAAP;AACH;AAED;;;AACe,YAAJE,IAAI,GAAW;AACtB,iBAAO,KAAKF,KAAL,CAAW,MAAX,KAAsB,IAA7B;AACH;;AAGD;AACe,YAAJG,IAAI,GAAQ;AACnB,iBAAO,KAAKH,KAAZ;AACH;AAED;;;AACAI,QAAAA,WAAW,GAAG;AAAA,eAPNJ,KAOM,GAPO,IAOP;;AACV,cAAI,CAACJ,GAAG,CAACS,SAAT,EAAoB;AAChB,iBAAKL,KAAL,GAAa,EAAb;AACA;AACH;;AACD,eAAKA,KAAL,GAAa,KAAKM,QAAL,EAAb;;AAEA,cAAI,CAAC,KAAKN,KAAL,CAAW,UAAX,CAAL,EAA6B;AACzB,iBAAKA,KAAL,CAAW,UAAX,IAAyB;AAAA;AAAA,0CAAWO,IAAX,EAAzB;AACH;;AAED;AAAA;AAAA,4BAAKC,GAAL,CAASC,SAAT,CAAmB,KAAKT,KAAxB,EAA+B,MAA/B;AACH;;AAEOM,QAAAA,QAAQ,GAAG;AACf,cAAI,OAAOI,MAAP,KAAkB,QAAtB,EAAgC,OAAO,EAAP;AAChC,cAAI,CAACA,MAAM,CAACC,QAAZ,EAAsB,OAAO,EAAP;AAEtB,cAAIC,GAAG,GAAGF,MAAM,CAACC,QAAP,CAAgBE,QAAhB,CAAyBC,IAAzB,CAA8BC,QAA9B,EAAV;AACA,cAAIC,CAAC,GAAGJ,GAAG,CAACK,KAAJ,CAAU,GAAV,CAAR;;AACA,cAAI,OAAQD,CAAC,CAAC,CAAD,CAAT,IAAiB,QAArB,EAA+B;AAC3BA,YAAAA,CAAC,GAAGA,CAAC,CAAC,CAAD,CAAD,CAAKC,KAAL,CAAW,GAAX,CAAJ;AACA,gBAAIC,GAAQ,GAAG,EAAf;;AACA,iBAAK,IAAIC,CAAC,GAAG,CAAR,EAAWC,CAAC,GAAGJ,CAAC,CAACK,MAAtB,EAA8BF,CAAC,GAAGC,CAAlC,EAAqC,EAAED,CAAvC,EAA0C;AACtC,kBAAIG,CAAC,GAAGN,CAAC,CAACG,CAAD,CAAT;AACA,kBAAII,CAAC,GAAGD,CAAC,CAACE,OAAF,CAAU,GAAV,CAAR;;AACA,kBAAID,CAAC,GAAG,CAAR,EAAW;AACP;AACH;;AACD,kBAAIE,GAAG,GAAGH,CAAC,CAACI,SAAF,CAAY,CAAZ,EAAeH,CAAf,CAAV;AACA,kBAAII,KAAK,GAAGL,CAAC,CAACI,SAAF,CAAYH,CAAC,GAAG,CAAhB,CAAZ;AACAL,cAAAA,GAAG,CAACU,kBAAkB,CAACH,GAAD,CAAnB,CAAH,GAA+BE,KAAK,IAAIC,kBAAkB,CAACD,KAAD,CAA1D;AACH;;AACD,mBAAOT,GAAP;AACH,WAdD,MAeK;AACD,mBAAO,EAAP;AACH;AACJ;;AA7DwB,O","sourcesContent":["/*\r\n * @Author: dgflash\r\n * @Date: 2022-04-14 17:08:01\r\n * @LastEditors: dgflash\r\n * @LastEditTime: 2022-09-06 17:29:45\r\n */\r\nimport { sys } from \"cc\";\r\nimport { oops } from \"../../core/Oops\";\r\nimport { StringUtil } from \"../../core/utils/StringUtil\";\r\n\r\n/**\r\n * 获取和处理浏览器地址栏参数\r\n * @example\r\n * config.query.data.username\r\n */\r\nexport class GameQueryConfig {\r\n    /** 调试模式开关 */\r\n    public get debug(): string {\r\n        return this._data[\"debug\"];\r\n    }\r\n\r\n    /** 玩家帐号名 */\r\n    public get username(): string {\r\n        return this._data[\"username\"];\r\n    }\r\n\r\n    /** 语言 */\r\n    public get lang(): string {\r\n        return this._data[\"lang\"] || \"zh\";\r\n    }\r\n\r\n    private _data: any = null;\r\n    /** 浏览器地址栏原始参数 */\r\n    public get data(): any {\r\n        return this._data;\r\n    }\r\n\r\n    /** 构造函数 */\r\n    constructor() {\r\n        if (!sys.isBrowser) {\r\n            this._data = {};\r\n            return;\r\n        }\r\n        this._data = this.parseUrl();\r\n\r\n        if (!this._data[\"username\"]) {\r\n            this._data[\"username\"] = StringUtil.guid();\r\n        }\r\n\r\n        oops.log.logConfig(this._data, \"查询参数\");\r\n    }\r\n\r\n    private parseUrl() {\r\n        if (typeof window !== \"object\") return {};\r\n        if (!window.document) return {};\r\n\r\n        let url = window.document.location.href.toString();\r\n        let u = url.split(\"?\");\r\n        if (typeof (u[1]) == \"string\") {\r\n            u = u[1].split(\"&\");\r\n            let get: any = {};\r\n            for (let i = 0, l = u.length; i < l; ++i) {\r\n                let j = u[i];\r\n                let x = j.indexOf(\"=\");\r\n                if (x < 0) {\r\n                    continue;\r\n                }\r\n                let key = j.substring(0, x);\r\n                let value = j.substring(x + 1);\r\n                get[decodeURIComponent(key)] = value && decodeURIComponent(value);\r\n            }\r\n            return get;\r\n        }\r\n        else {\r\n            return {};\r\n        }\r\n    }\r\n}"]}