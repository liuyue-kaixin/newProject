{"version":3,"sources":["file:///Volumes/SSD/ccProject/extensions/oops-plugin-framework/assets/libs/gui/language/LanguageSprite.ts"],"names":["CCString","Component","Sprite","SpriteFrame","UITransform","_decorator","EDITOR","oops","LanguageData","ccclass","property","menu","LanguageSprite","serializable","type","tooltip","dataID","_dataID","value","updateSprite","start","language","path","current","res","get","spcomp","getComponent","spriteFrame","isRawSize","rawSize","_originalSize","setContentSize","console","error"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAMSA,MAAAA,Q,OAAAA,Q;AAAUC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,U,OAAAA,U;;AAC7DC,MAAAA,M,UAAAA,M;;AACAC,MAAAA,I,iBAAAA,I;;AACAC,MAAAA,Y,iBAAAA,Y;;;;;;AATT;AACA;AACA;AACA;AACA;AACA;;;;;OAMM;AAAEC,QAAAA,OAAF;AAAWC,QAAAA,QAAX;AAAqBC,QAAAA;AAArB,O,GAA8BN,U;;gCAIvBO,c,WAFZH,OAAO,CAAC,gBAAD,C,UACPE,IAAI,CAAC,4BAAD,C,UAEAD,QAAQ,CAAC;AAAEG,QAAAA,YAAY,EAAE;AAAhB,OAAD,C,UAERH,QAAQ,CAAC;AAAEI,QAAAA,IAAI,EAAEd,QAAR;AAAkBa,QAAAA,YAAY,EAAE;AAAhC,OAAD,C,UAWRH,QAAQ,CAAC;AACNK,QAAAA,OAAO,EAAE;AADH,OAAD,C,0CAhBb,MAEaH,cAFb,SAEoCX,SAFpC,CAE8C;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAIhC,YAANe,MAAM,GAAW;AACjB,iBAAO,KAAKC,OAAL,IAAgB,EAAvB;AACH;;AACS,YAAND,MAAM,CAACE,KAAD,EAAgB;AACtB,eAAKD,OAAL,GAAeC,KAAf;;AACA,cAAI,CAACZ,MAAL,EAAa;AACT,iBAAKa,YAAL;AACH;AACJ;;AAODC,QAAAA,KAAK,GAAG;AACJ,eAAKD,YAAL;AACH;AAED;;;AACAE,QAAAA,QAAQ,GAAG;AACP,eAAKF,YAAL;AACH;;AAEOA,QAAAA,YAAY,GAAG;AACnB;AACA,cAAIG,IAAI,yBAAuB;AAAA;AAAA,4CAAaC,OAApC,SAA+C,KAAKP,MAApD,iBAAR;AACA,cAAIQ,GAAuB,GAAG;AAAA;AAAA,4BAAKA,GAAL,CAASC,GAAT,CAAaH,IAAb,EAAmBnB,WAAnB,CAA9B;;AACA,cAAIqB,GAAJ,EAAS;AACL,gBAAIE,MAAc,GAAG,KAAKC,YAAL,CAAkBzB,MAAlB,CAArB;AACAwB,YAAAA,MAAM,CAACE,WAAP,GAAqBJ,GAArB;AAEA;;AACA,gBAAI,KAAKK,SAAT,EAAoB;AAAA;;AAChB;AACA,kBAAIC,OAAO,GAAGN,GAAG,CAACO,aAAlB;AACA,sCAAAL,MAAM,CAACC,YAAP,CAAoBvB,WAApB,mCAAkC4B,cAAlC,CAAiDF,OAAjD;AACH;AACJ,WAVD,MAWK;AACDG,YAAAA,OAAO,CAACC,KAAR,CAAc,4BAA4BZ,IAA1C;AACH;AACJ;;AA9CyC,O;;;;;iBAEhB,E;;;;;;;iBAeG,I","sourcesContent":["/*\r\n * @Author: dgflash\r\n * @Date: 2021-11-24 15:51:01\r\n * @LastEditors: dgflash\r\n * @LastEditTime: 2022-09-02 10:04:57\r\n */\r\nimport { CCString, Component, Size, Sprite, SpriteFrame, UITransform, _decorator } from \"cc\";\r\nimport { EDITOR } from \"cc/env\";\r\nimport { oops } from \"../../../core/Oops\";\r\nimport { LanguageData } from \"./LanguageData\";\r\n\r\nconst { ccclass, property, menu } = _decorator;\r\n\r\n@ccclass(\"LanguageSprite\")\r\n@menu('ui/language/LanguageSprite')\r\nexport class LanguageSprite extends Component {\r\n    @property({ serializable: true })\r\n    private _dataID: string = \"\";\r\n    @property({ type: CCString, serializable: true })\r\n    get dataID(): string {\r\n        return this._dataID || \"\";\r\n    }\r\n    set dataID(value: string) {\r\n        this._dataID = value;\r\n        if (!EDITOR) {\r\n            this.updateSprite();\r\n        }\r\n    }\r\n\r\n    @property({\r\n        tooltip: \"是否设置为图片原始资源大小\"\r\n    })\r\n    private isRawSize: boolean = true;\r\n\r\n    start() {\r\n        this.updateSprite();\r\n    }\r\n\r\n    /** 更新语言 */\r\n    language() {\r\n        this.updateSprite();\r\n    }\r\n\r\n    private updateSprite() {\r\n        // 获取语言标记\r\n        let path = `language/texture/${LanguageData.current}/${this.dataID}/spriteFrame`;\r\n        let res: SpriteFrame | null = oops.res.get(path, SpriteFrame);\r\n        if (res) {\r\n            let spcomp: Sprite = this.getComponent(Sprite)!;\r\n            spcomp.spriteFrame = res;\r\n\r\n            /** 修改节点为原始图片资源大小 */\r\n            if (this.isRawSize) {\r\n                //@ts-ignore\r\n                let rawSize = res._originalSize as Size;\r\n                spcomp.getComponent(UITransform)?.setContentSize(rawSize);\r\n            }\r\n        }\r\n        else {\r\n            console.error(\"[LanguageSprite] 资源不存在 \" + path);\r\n        }\r\n    }\r\n}"]}