{"version":3,"sources":["file:///Volumes/SSD/ccProject/node_modules/crypto-es/lib/cipher-core.js"],"names":["Cipher","StreamCipher","BlockCipherMode","CBC","BlockCipher","CipherParams","SerializableCipher","PasswordBasedCipher","xorBlock","words","offset","blockSize","_words","block","iv","_iv","undefined","_prevBlock","i","Base","WordArray","BufferedBlockAlgorithm","Base64","EvpKDFAlgo","constructor","xformMode","key","cfg","Object","assign","_xformMode","_key","reset","createEncryptor","create","_ENC_XFORM_MODE","createDecryptor","_DEC_XFORM_MODE","_createHelper","SubCipher","selectCipherStrategy","encrypt","message","decrypt","ciphertext","call","_doReset","process","dataUpdate","_append","_process","finalize","finalProcessedData","_doFinalize","keySize","ivSize","finalProcessedBlocks","cipher","_cipher","Encryptor","Decryptor","processBlock","encryptBlock","slice","thisBlock","decryptBlock","Pkcs7","pad","data","blockSizeBytes","nPaddingBytes","sigBytes","paddingWord","paddingWords","push","padding","concat","unpad","_data","mode","modeCreator","_minBufferSize","_mode","__creator","_doProcessBlock","cipherParams","mixIn","toString","formatter","stringify","OpenSSLFormatter","wordArray","salt","parse","openSSLStr","ciphertextWords","splice","_cfg","encryptor","cipherCfg","algorithm","format","_ciphertext","_parse","plaintext","OpenSSLKdf","execute","password","_salt","random","compute","derivedParams","kdf"],"mappings":"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","sourcesContent":["/* eslint-disable no-use-before-define */\r\n\r\nimport {\r\n  Base,\r\n  WordArray,\r\n  BufferedBlockAlgorithm,\r\n} from './core.js';\r\nimport { Base64 } from './enc-base64.js';\r\nimport { EvpKDFAlgo } from './evpkdf.js';\r\n\r\n/**\r\n * Abstract base cipher template.\r\n *\r\n * @property {number} keySize This cipher's key size. Default: 4 (128 bits)\r\n * @property {number} ivSize This cipher's IV size. Default: 4 (128 bits)\r\n * @property {number} _ENC_XFORM_MODE A constant representing encryption mode.\r\n * @property {number} _DEC_XFORM_MODE A constant representing decryption mode.\r\n */\r\nexport class Cipher extends BufferedBlockAlgorithm {\r\n  /**\r\n   * Initializes a newly created cipher.\r\n   *\r\n   * @param {number} xformMode Either the encryption or decryption transormation mode constant.\r\n   * @param {WordArray} key The key.\r\n   * @param {Object} cfg (Optional) The configuration options to use for this operation.\r\n   *\r\n   * @example\r\n   *\r\n   *     const cipher = CryptoJS.algo.AES.create(\r\n   *       CryptoJS.algo.AES._ENC_XFORM_MODE, keyWordArray, { iv: ivWordArray }\r\n   *     );\r\n   */\r\n  constructor(xformMode, key, cfg) {\r\n    super();\r\n\r\n    /**\r\n     * Configuration options.\r\n     *\r\n     * @property {WordArray} iv The IV to use for this operation.\r\n     */\r\n    this.cfg = Object.assign(new Base(), cfg);\r\n\r\n    // Store transform mode and key\r\n    this._xformMode = xformMode;\r\n    this._key = key;\r\n\r\n    // Set initial values\r\n    this.reset();\r\n  }\r\n\r\n  /**\r\n   * Creates this cipher in encryption mode.\r\n   *\r\n   * @param {WordArray} key The key.\r\n   * @param {Object} cfg (Optional) The configuration options to use for this operation.\r\n   *\r\n   * @return {Cipher} A cipher instance.\r\n   *\r\n   * @static\r\n   *\r\n   * @example\r\n   *\r\n   *     const cipher = CryptoJS.algo.AES.createEncryptor(keyWordArray, { iv: ivWordArray });\r\n   */\r\n  static createEncryptor(key, cfg) {\r\n    return this.create(this._ENC_XFORM_MODE, key, cfg);\r\n  }\r\n\r\n  /**\r\n   * Creates this cipher in decryption mode.\r\n   *\r\n   * @param {WordArray} key The key.\r\n   * @param {Object} cfg (Optional) The configuration options to use for this operation.\r\n   *\r\n   * @return {Cipher} A cipher instance.\r\n   *\r\n   * @static\r\n   *\r\n   * @example\r\n   *\r\n   *     const cipher = CryptoJS.algo.AES.createDecryptor(keyWordArray, { iv: ivWordArray });\r\n   */\r\n  static createDecryptor(key, cfg) {\r\n    return this.create(this._DEC_XFORM_MODE, key, cfg);\r\n  }\r\n\r\n  /**\r\n   * Creates shortcut functions to a cipher's object interface.\r\n   *\r\n   * @param {Cipher} cipher The cipher to create a helper for.\r\n   *\r\n   * @return {Object} An object with encrypt and decrypt shortcut functions.\r\n   *\r\n   * @static\r\n   *\r\n   * @example\r\n   *\r\n   *     const AES = CryptoJS.lib.Cipher._createHelper(CryptoJS.algo.AES);\r\n   */\r\n  static _createHelper(SubCipher) {\r\n    const selectCipherStrategy = (key) => {\r\n      if (typeof key === 'string') {\r\n        return PasswordBasedCipher;\r\n      }\r\n      return SerializableCipher;\r\n    };\r\n\r\n    return {\r\n      encrypt(message, key, cfg) {\r\n        return selectCipherStrategy(key).encrypt(SubCipher, message, key, cfg);\r\n      },\r\n\r\n      decrypt(ciphertext, key, cfg) {\r\n        return selectCipherStrategy(key).decrypt(SubCipher, ciphertext, key, cfg);\r\n      },\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Resets this cipher to its initial state.\r\n   *\r\n   * @example\r\n   *\r\n   *     cipher.reset();\r\n   */\r\n  reset() {\r\n    // Reset data buffer\r\n    super.reset.call(this);\r\n\r\n    // Perform concrete-cipher logic\r\n    this._doReset();\r\n  }\r\n\r\n  /**\r\n   * Adds data to be encrypted or decrypted.\r\n   *\r\n   * @param {WordArray|string} dataUpdate The data to encrypt or decrypt.\r\n   *\r\n   * @return {WordArray} The data after processing.\r\n   *\r\n   * @example\r\n   *\r\n   *     const encrypted = cipher.process('data');\r\n   *     const encrypted = cipher.process(wordArray);\r\n   */\r\n  process(dataUpdate) {\r\n    // Append\r\n    this._append(dataUpdate);\r\n\r\n    // Process available blocks\r\n    return this._process();\r\n  }\r\n\r\n  /**\r\n   * Finalizes the encryption or decryption process.\r\n   * Note that the finalize operation is effectively a destructive, read-once operation.\r\n   *\r\n   * @param {WordArray|string} dataUpdate The final data to encrypt or decrypt.\r\n   *\r\n   * @return {WordArray} The data after final processing.\r\n   *\r\n   * @example\r\n   *\r\n   *     const encrypted = cipher.finalize();\r\n   *     const encrypted = cipher.finalize('data');\r\n   *     const encrypted = cipher.finalize(wordArray);\r\n   */\r\n  finalize(dataUpdate) {\r\n    // Final data update\r\n    if (dataUpdate) {\r\n      this._append(dataUpdate);\r\n    }\r\n\r\n    // Perform concrete-cipher logic\r\n    const finalProcessedData = this._doFinalize();\r\n\r\n    return finalProcessedData;\r\n  }\r\n}\r\nCipher._ENC_XFORM_MODE = 1;\r\nCipher._DEC_XFORM_MODE = 2;\r\nCipher.keySize = 128 / 32;\r\nCipher.ivSize = 128 / 32;\r\n\r\n/**\r\n * Abstract base stream cipher template.\r\n *\r\n * @property {number} blockSize\r\n *\r\n *     The number of 32-bit words this cipher operates on. Default: 1 (32 bits)\r\n */\r\nexport class StreamCipher extends Cipher {\r\n  constructor(...args) {\r\n    super(...args);\r\n\r\n    this.blockSize = 1;\r\n  }\r\n\r\n  _doFinalize() {\r\n    // Process partial blocks\r\n    const finalProcessedBlocks = this._process(!!'flush');\r\n\r\n    return finalProcessedBlocks;\r\n  }\r\n}\r\n\r\n/**\r\n * Abstract base block cipher mode template.\r\n */\r\nexport class BlockCipherMode extends Base {\r\n  /**\r\n   * Initializes a newly created mode.\r\n   *\r\n   * @param {Cipher} cipher A block cipher instance.\r\n   * @param {Array} iv The IV words.\r\n   *\r\n   * @example\r\n   *\r\n   *     const mode = CryptoJS.mode.CBC.Encryptor.create(cipher, iv.words);\r\n   */\r\n  constructor(cipher, iv) {\r\n    super();\r\n\r\n    this._cipher = cipher;\r\n    this._iv = iv;\r\n  }\r\n\r\n  /**\r\n   * Creates this mode for encryption.\r\n   *\r\n   * @param {Cipher} cipher A block cipher instance.\r\n   * @param {Array} iv The IV words.\r\n   *\r\n   * @static\r\n   *\r\n   * @example\r\n   *\r\n   *     const mode = CryptoJS.mode.CBC.createEncryptor(cipher, iv.words);\r\n   */\r\n  static createEncryptor(cipher, iv) {\r\n    return this.Encryptor.create(cipher, iv);\r\n  }\r\n\r\n  /**\r\n   * Creates this mode for decryption.\r\n   *\r\n   * @param {Cipher} cipher A block cipher instance.\r\n   * @param {Array} iv The IV words.\r\n   *\r\n   * @static\r\n   *\r\n   * @example\r\n   *\r\n   *     const mode = CryptoJS.mode.CBC.createDecryptor(cipher, iv.words);\r\n   */\r\n  static createDecryptor(cipher, iv) {\r\n    return this.Decryptor.create(cipher, iv);\r\n  }\r\n}\r\n\r\nfunction xorBlock(words, offset, blockSize) {\r\n  const _words = words;\r\n  let block;\r\n\r\n  // Shortcut\r\n  const iv = this._iv;\r\n\r\n  // Choose mixing block\r\n  if (iv) {\r\n    block = iv;\r\n\r\n    // Remove IV for subsequent blocks\r\n    this._iv = undefined;\r\n  } else {\r\n    block = this._prevBlock;\r\n  }\r\n\r\n  // XOR blocks\r\n  for (let i = 0; i < blockSize; i += 1) {\r\n    _words[offset + i] ^= block[i];\r\n  }\r\n}\r\n\r\n/**\r\n * Cipher Block Chaining mode.\r\n */\r\n\r\n/**\r\n * Abstract base CBC mode.\r\n */\r\nexport class CBC extends BlockCipherMode {\r\n}\r\n/**\r\n * CBC encryptor.\r\n */\r\nCBC.Encryptor = class extends CBC {\r\n  /**\r\n   * Processes the data block at offset.\r\n   *\r\n   * @param {Array} words The data words to operate on.\r\n   * @param {number} offset The offset where the block starts.\r\n   *\r\n   * @example\r\n   *\r\n   *     mode.processBlock(data.words, offset);\r\n   */\r\n  processBlock(words, offset) {\r\n    // Shortcuts\r\n    const cipher = this._cipher;\r\n    const { blockSize } = cipher;\r\n\r\n    // XOR and encrypt\r\n    xorBlock.call(this, words, offset, blockSize);\r\n    cipher.encryptBlock(words, offset);\r\n\r\n    // Remember this block to use with next block\r\n    this._prevBlock = words.slice(offset, offset + blockSize);\r\n  }\r\n};\r\n/**\r\n * CBC decryptor.\r\n */\r\nCBC.Decryptor = class extends CBC {\r\n  /**\r\n   * Processes the data block at offset.\r\n   *\r\n   * @param {Array} words The data words to operate on.\r\n   * @param {number} offset The offset where the block starts.\r\n   *\r\n   * @example\r\n   *\r\n   *     mode.processBlock(data.words, offset);\r\n   */\r\n  processBlock(words, offset) {\r\n    // Shortcuts\r\n    const cipher = this._cipher;\r\n    const { blockSize } = cipher;\r\n\r\n    // Remember this block to use with next block\r\n    const thisBlock = words.slice(offset, offset + blockSize);\r\n\r\n    // Decrypt and XOR\r\n    cipher.decryptBlock(words, offset);\r\n    xorBlock.call(this, words, offset, blockSize);\r\n\r\n    // This block becomes the previous block\r\n    this._prevBlock = thisBlock;\r\n  }\r\n};\r\n\r\n/**\r\n * PKCS #5/7 padding strategy.\r\n */\r\nexport const Pkcs7 = {\r\n  /**\r\n   * Pads data using the algorithm defined in PKCS #5/7.\r\n   *\r\n   * @param {WordArray} data The data to pad.\r\n   * @param {number} blockSize The multiple that the data should be padded to.\r\n   *\r\n   * @static\r\n   *\r\n   * @example\r\n   *\r\n   *     CryptoJS.pad.Pkcs7.pad(wordArray, 4);\r\n   */\r\n  pad(data, blockSize) {\r\n    // Shortcut\r\n    const blockSizeBytes = blockSize * 4;\r\n\r\n    // Count padding bytes\r\n    const nPaddingBytes = blockSizeBytes - (data.sigBytes % blockSizeBytes);\r\n\r\n    // Create padding word\r\n    const paddingWord = (nPaddingBytes << 24)\r\n      | (nPaddingBytes << 16)\r\n      | (nPaddingBytes << 8)\r\n      | nPaddingBytes;\r\n\r\n    // Create padding\r\n    const paddingWords = [];\r\n    for (let i = 0; i < nPaddingBytes; i += 4) {\r\n      paddingWords.push(paddingWord);\r\n    }\r\n    const padding = WordArray.create(paddingWords, nPaddingBytes);\r\n\r\n    // Add padding\r\n    data.concat(padding);\r\n  },\r\n\r\n  /**\r\n   * Unpads data that had been padded using the algorithm defined in PKCS #5/7.\r\n   *\r\n   * @param {WordArray} data The data to unpad.\r\n   *\r\n   * @static\r\n   *\r\n   * @example\r\n   *\r\n   *     CryptoJS.pad.Pkcs7.unpad(wordArray);\r\n   */\r\n  unpad(data) {\r\n    const _data = data;\r\n\r\n    // Get number of padding bytes from last byte\r\n    const nPaddingBytes = _data.words[(_data.sigBytes - 1) >>> 2] & 0xff;\r\n\r\n    // Remove padding\r\n    _data.sigBytes -= nPaddingBytes;\r\n  },\r\n};\r\n\r\n/**\r\n * Abstract base block cipher template.\r\n *\r\n * @property {number} blockSize\r\n *\r\n *    The number of 32-bit words this cipher operates on. Default: 4 (128 bits)\r\n */\r\nexport class BlockCipher extends Cipher {\r\n  constructor(xformMode, key, cfg) {\r\n    /**\r\n     * Configuration options.\r\n     *\r\n     * @property {Mode} mode The block mode to use. Default: CBC\r\n     * @property {Padding} padding The padding strategy to use. Default: Pkcs7\r\n     */\r\n    super(xformMode, key, Object.assign(\r\n      {\r\n        mode: CBC,\r\n        padding: Pkcs7,\r\n      },\r\n      cfg,\r\n    ));\r\n\r\n    this.blockSize = 128 / 32;\r\n  }\r\n\r\n  reset() {\r\n    let modeCreator;\r\n\r\n    // Reset cipher\r\n    super.reset.call(this);\r\n\r\n    // Shortcuts\r\n    const { cfg } = this;\r\n    const { iv, mode } = cfg;\r\n\r\n    // Reset block mode\r\n    if (this._xformMode === this.constructor._ENC_XFORM_MODE) {\r\n      modeCreator = mode.createEncryptor;\r\n    } else /* if (this._xformMode == this._DEC_XFORM_MODE) */ {\r\n      modeCreator = mode.createDecryptor;\r\n      // Keep at least one block in the buffer for unpadding\r\n      this._minBufferSize = 1;\r\n    }\r\n\r\n    this._mode = modeCreator.call(mode, this, iv && iv.words);\r\n    this._mode.__creator = modeCreator;\r\n  }\r\n\r\n  _doProcessBlock(words, offset) {\r\n    this._mode.processBlock(words, offset);\r\n  }\r\n\r\n  _doFinalize() {\r\n    let finalProcessedBlocks;\r\n\r\n    // Shortcut\r\n    const { padding } = this.cfg;\r\n\r\n    // Finalize\r\n    if (this._xformMode === this.constructor._ENC_XFORM_MODE) {\r\n      // Pad data\r\n      padding.pad(this._data, this.blockSize);\r\n\r\n      // Process final blocks\r\n      finalProcessedBlocks = this._process(!!'flush');\r\n    } else /* if (this._xformMode == this._DEC_XFORM_MODE) */ {\r\n      // Process final blocks\r\n      finalProcessedBlocks = this._process(!!'flush');\r\n\r\n      // Unpad data\r\n      padding.unpad(finalProcessedBlocks);\r\n    }\r\n\r\n    return finalProcessedBlocks;\r\n  }\r\n}\r\n\r\n/**\r\n * A collection of cipher parameters.\r\n *\r\n * @property {WordArray} ciphertext The raw ciphertext.\r\n * @property {WordArray} key The key to this ciphertext.\r\n * @property {WordArray} iv The IV used in the ciphering operation.\r\n * @property {WordArray} salt The salt used with a key derivation function.\r\n * @property {Cipher} algorithm The cipher algorithm.\r\n * @property {Mode} mode The block mode used in the ciphering operation.\r\n * @property {Padding} padding The padding scheme used in the ciphering operation.\r\n * @property {number} blockSize The block size of the cipher.\r\n * @property {Format} formatter\r\n *    The default formatting strategy to convert this cipher params object to a string.\r\n */\r\nexport class CipherParams extends Base {\r\n  /**\r\n   * Initializes a newly created cipher params object.\r\n   *\r\n   * @param {Object} cipherParams An object with any of the possible cipher parameters.\r\n   *\r\n   * @example\r\n   *\r\n   *     var cipherParams = CryptoJS.lib.CipherParams.create({\r\n   *         ciphertext: ciphertextWordArray,\r\n   *         key: keyWordArray,\r\n   *         iv: ivWordArray,\r\n   *         salt: saltWordArray,\r\n   *         algorithm: CryptoJS.algo.AES,\r\n   *         mode: CryptoJS.mode.CBC,\r\n   *         padding: CryptoJS.pad.PKCS7,\r\n   *         blockSize: 4,\r\n   *         formatter: CryptoJS.format.OpenSSL\r\n   *     });\r\n   */\r\n  constructor(cipherParams) {\r\n    super();\r\n\r\n    this.mixIn(cipherParams);\r\n  }\r\n\r\n  /**\r\n   * Converts this cipher params object to a string.\r\n   *\r\n   * @param {Format} formatter (Optional) The formatting strategy to use.\r\n   *\r\n   * @return {string} The stringified cipher params.\r\n   *\r\n   * @throws Error If neither the formatter nor the default formatter is set.\r\n   *\r\n   * @example\r\n   *\r\n   *     var string = cipherParams + '';\r\n   *     var string = cipherParams.toString();\r\n   *     var string = cipherParams.toString(CryptoJS.format.OpenSSL);\r\n   */\r\n  toString(formatter) {\r\n    return (formatter || this.formatter).stringify(this);\r\n  }\r\n}\r\n\r\n/**\r\n * OpenSSL formatting strategy.\r\n */\r\nexport const OpenSSLFormatter = {\r\n  /**\r\n   * Converts a cipher params object to an OpenSSL-compatible string.\r\n   *\r\n   * @param {CipherParams} cipherParams The cipher params object.\r\n   *\r\n   * @return {string} The OpenSSL-compatible string.\r\n   *\r\n   * @static\r\n   *\r\n   * @example\r\n   *\r\n   *     var openSSLString = CryptoJS.format.OpenSSL.stringify(cipherParams);\r\n   */\r\n  stringify(cipherParams) {\r\n    let wordArray;\r\n\r\n    // Shortcuts\r\n    const { ciphertext, salt } = cipherParams;\r\n\r\n    // Format\r\n    if (salt) {\r\n      wordArray = WordArray.create([0x53616c74, 0x65645f5f]).concat(salt).concat(ciphertext);\r\n    } else {\r\n      wordArray = ciphertext;\r\n    }\r\n\r\n    return wordArray.toString(Base64);\r\n  },\r\n\r\n  /**\r\n   * Converts an OpenSSL-compatible string to a cipher params object.\r\n   *\r\n   * @param {string} openSSLStr The OpenSSL-compatible string.\r\n   *\r\n   * @return {CipherParams} The cipher params object.\r\n   *\r\n   * @static\r\n   *\r\n   * @example\r\n   *\r\n   *     var cipherParams = CryptoJS.format.OpenSSL.parse(openSSLString);\r\n   */\r\n  parse(openSSLStr) {\r\n    let salt;\r\n\r\n    // Parse base64\r\n    const ciphertext = Base64.parse(openSSLStr);\r\n\r\n    // Shortcut\r\n    const ciphertextWords = ciphertext.words;\r\n\r\n    // Test for salt\r\n    if (ciphertextWords[0] === 0x53616c74 && ciphertextWords[1] === 0x65645f5f) {\r\n      // Extract salt\r\n      salt = WordArray.create(ciphertextWords.slice(2, 4));\r\n\r\n      // Remove salt from ciphertext\r\n      ciphertextWords.splice(0, 4);\r\n      ciphertext.sigBytes -= 16;\r\n    }\r\n\r\n    return CipherParams.create({ ciphertext, salt });\r\n  },\r\n};\r\n\r\n/**\r\n * A cipher wrapper that returns ciphertext as a serializable cipher params object.\r\n */\r\nexport class SerializableCipher extends Base {\r\n  /**\r\n   * Encrypts a message.\r\n   *\r\n   * @param {Cipher} cipher The cipher algorithm to use.\r\n   * @param {WordArray|string} message The message to encrypt.\r\n   * @param {WordArray} key The key.\r\n   * @param {Object} cfg (Optional) The configuration options to use for this operation.\r\n   *\r\n   * @return {CipherParams} A cipher params object.\r\n   *\r\n   * @static\r\n   *\r\n   * @example\r\n   *\r\n   *     var ciphertextParams = CryptoJS.lib.SerializableCipher\r\n   *       .encrypt(CryptoJS.algo.AES, message, key);\r\n   *     var ciphertextParams = CryptoJS.lib.SerializableCipher\r\n   *       .encrypt(CryptoJS.algo.AES, message, key, { iv: iv });\r\n   *     var ciphertextParams = CryptoJS.lib.SerializableCipher\r\n   *       .encrypt(CryptoJS.algo.AES, message, key, { iv: iv, format: CryptoJS.format.OpenSSL });\r\n   */\r\n  static encrypt(cipher, message, key, cfg) {\r\n    // Apply config defaults\r\n    const _cfg = Object.assign(new Base(), this.cfg, cfg);\r\n\r\n    // Encrypt\r\n    const encryptor = cipher.createEncryptor(key, _cfg);\r\n    const ciphertext = encryptor.finalize(message);\r\n\r\n    // Shortcut\r\n    const cipherCfg = encryptor.cfg;\r\n\r\n    // Create and return serializable cipher params\r\n    return CipherParams.create({\r\n      ciphertext,\r\n      key,\r\n      iv: cipherCfg.iv,\r\n      algorithm: cipher,\r\n      mode: cipherCfg.mode,\r\n      padding: cipherCfg.padding,\r\n      blockSize: encryptor.blockSize,\r\n      formatter: _cfg.format,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Decrypts serialized ciphertext.\r\n   *\r\n   * @param {Cipher} cipher The cipher algorithm to use.\r\n   * @param {CipherParams|string} ciphertext The ciphertext to decrypt.\r\n   * @param {WordArray} key The key.\r\n   * @param {Object} cfg (Optional) The configuration options to use for this operation.\r\n   *\r\n   * @return {WordArray} The plaintext.\r\n   *\r\n   * @static\r\n   *\r\n   * @example\r\n   *\r\n   *     var plaintext = CryptoJS.lib.SerializableCipher\r\n   *       .decrypt(CryptoJS.algo.AES, formattedCiphertext, key,\r\n   *         { iv: iv, format: CryptoJS.format.OpenSSL });\r\n   *     var plaintext = CryptoJS.lib.SerializableCipher\r\n   *       .decrypt(CryptoJS.algo.AES, ciphertextParams, key,\r\n   *         { iv: iv, format: CryptoJS.format.OpenSSL });\r\n   */\r\n  static decrypt(cipher, ciphertext, key, cfg) {\r\n    let _ciphertext = ciphertext;\r\n\r\n    // Apply config defaults\r\n    const _cfg = Object.assign(new Base(), this.cfg, cfg);\r\n\r\n    // Convert string to CipherParams\r\n    _ciphertext = this._parse(_ciphertext, _cfg.format);\r\n\r\n    // Decrypt\r\n    const plaintext = cipher.createDecryptor(key, _cfg).finalize(_ciphertext.ciphertext);\r\n\r\n    return plaintext;\r\n  }\r\n\r\n  /**\r\n   * Converts serialized ciphertext to CipherParams,\r\n   * else assumed CipherParams already and returns ciphertext unchanged.\r\n   *\r\n   * @param {CipherParams|string} ciphertext The ciphertext.\r\n   * @param {Formatter} format The formatting strategy to use to parse serialized ciphertext.\r\n   *\r\n   * @return {CipherParams} The unserialized ciphertext.\r\n   *\r\n   * @static\r\n   *\r\n   * @example\r\n   *\r\n   *     var ciphertextParams = CryptoJS.lib.SerializableCipher\r\n   *       ._parse(ciphertextStringOrParams, format);\r\n   */\r\n  static _parse(ciphertext, format) {\r\n    if (typeof ciphertext === 'string') {\r\n      return format.parse(ciphertext, this);\r\n    }\r\n    return ciphertext;\r\n  }\r\n}\r\n/**\r\n * Configuration options.\r\n *\r\n * @property {Formatter} format\r\n *\r\n *    The formatting strategy to convert cipher param objects to and from a string.\r\n *    Default: OpenSSL\r\n */\r\nSerializableCipher.cfg = Object.assign(\r\n  new Base(),\r\n  { format: OpenSSLFormatter },\r\n);\r\n\r\n/**\r\n * OpenSSL key derivation function.\r\n */\r\nexport const OpenSSLKdf = {\r\n  /**\r\n   * Derives a key and IV from a password.\r\n   *\r\n   * @param {string} password The password to derive from.\r\n   * @param {number} keySize The size in words of the key to generate.\r\n   * @param {number} ivSize The size in words of the IV to generate.\r\n   * @param {WordArray|string} salt\r\n   *     (Optional) A 64-bit salt to use. If omitted, a salt will be generated randomly.\r\n   *\r\n   * @return {CipherParams} A cipher params object with the key, IV, and salt.\r\n   *\r\n   * @static\r\n   *\r\n   * @example\r\n   *\r\n   *     var derivedParams = CryptoJS.kdf.OpenSSL.execute('Password', 256/32, 128/32);\r\n   *     var derivedParams = CryptoJS.kdf.OpenSSL.execute('Password', 256/32, 128/32, 'saltsalt');\r\n   */\r\n  execute(password, keySize, ivSize, salt) {\r\n    let _salt = salt;\r\n\r\n    // Generate random salt\r\n    if (!_salt) {\r\n      _salt = WordArray.random(64 / 8);\r\n    }\r\n\r\n    // Derive key and IV\r\n    const key = EvpKDFAlgo.create({ keySize: keySize + ivSize }).compute(password, _salt);\r\n\r\n    // Separate key and IV\r\n    const iv = WordArray.create(key.words.slice(keySize), ivSize * 4);\r\n    key.sigBytes = keySize * 4;\r\n\r\n    // Return params\r\n    return CipherParams.create({ key, iv, salt: _salt });\r\n  },\r\n};\r\n\r\n/**\r\n * A serializable cipher wrapper that derives the key from a password,\r\n * and returns ciphertext as a serializable cipher params object.\r\n */\r\nexport class PasswordBasedCipher extends SerializableCipher {\r\n  /**\r\n   * Encrypts a message using a password.\r\n   *\r\n   * @param {Cipher} cipher The cipher algorithm to use.\r\n   * @param {WordArray|string} message The message to encrypt.\r\n   * @param {string} password The password.\r\n   * @param {Object} cfg (Optional) The configuration options to use for this operation.\r\n   *\r\n   * @return {CipherParams} A cipher params object.\r\n   *\r\n   * @static\r\n   *\r\n   * @example\r\n   *\r\n   *     var ciphertextParams = CryptoJS.lib.PasswordBasedCipher\r\n   *       .encrypt(CryptoJS.algo.AES, message, 'password');\r\n   *     var ciphertextParams = CryptoJS.lib.PasswordBasedCipher\r\n   *       .encrypt(CryptoJS.algo.AES, message, 'password', { format: CryptoJS.format.OpenSSL });\r\n   */\r\n  static encrypt(cipher, message, password, cfg) {\r\n    // Apply config defaults\r\n    const _cfg = Object.assign(new Base(), this.cfg, cfg);\r\n\r\n    // Derive key and other params\r\n    const derivedParams = _cfg.kdf.execute(password, cipher.keySize, cipher.ivSize);\r\n\r\n    // Add IV to config\r\n    _cfg.iv = derivedParams.iv;\r\n\r\n    // Encrypt\r\n    const ciphertext = SerializableCipher.encrypt\r\n      .call(this, cipher, message, derivedParams.key, _cfg);\r\n\r\n    // Mix in derived params\r\n    ciphertext.mixIn(derivedParams);\r\n\r\n    return ciphertext;\r\n  }\r\n\r\n  /**\r\n   * Decrypts serialized ciphertext using a password.\r\n   *\r\n   * @param {Cipher} cipher The cipher algorithm to use.\r\n   * @param {CipherParams|string} ciphertext The ciphertext to decrypt.\r\n   * @param {string} password The password.\r\n   * @param {Object} cfg (Optional) The configuration options to use for this operation.\r\n   *\r\n   * @return {WordArray} The plaintext.\r\n   *\r\n   * @static\r\n   *\r\n   * @example\r\n   *\r\n   *     var plaintext = CryptoJS.lib.PasswordBasedCipher\r\n   *       .decrypt(CryptoJS.algo.AES, formattedCiphertext, 'password',\r\n   *         { format: CryptoJS.format.OpenSSL });\r\n   *     var plaintext = CryptoJS.lib.PasswordBasedCipher\r\n   *       .decrypt(CryptoJS.algo.AES, ciphertextParams, 'password',\r\n   *         { format: CryptoJS.format.OpenSSL });\r\n   */\r\n  static decrypt(cipher, ciphertext, password, cfg) {\r\n    let _ciphertext = ciphertext;\r\n\r\n    // Apply config defaults\r\n    const _cfg = Object.assign(new Base(), this.cfg, cfg);\r\n\r\n    // Convert string to CipherParams\r\n    _ciphertext = this._parse(_ciphertext, _cfg.format);\r\n\r\n    // Derive key and other params\r\n    const derivedParams = _cfg.kdf\r\n      .execute(password, cipher.keySize, cipher.ivSize, _ciphertext.salt);\r\n\r\n    // Add IV to config\r\n    _cfg.iv = derivedParams.iv;\r\n\r\n    // Decrypt\r\n    const plaintext = SerializableCipher.decrypt\r\n      .call(this, cipher, _ciphertext, derivedParams.key, _cfg);\r\n\r\n    return plaintext;\r\n  }\r\n}\r\n/**\r\n * Configuration options.\r\n *\r\n * @property {KDF} kdf\r\n *     The key derivation function to use to generate a key and IV from a password.\r\n *     Default: OpenSSL\r\n */\r\nPasswordBasedCipher.cfg = Object.assign(SerializableCipher.cfg, { kdf: OpenSSLKdf });\r\n"]}