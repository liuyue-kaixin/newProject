{"version":3,"sources":["file:///Volumes/SSD/ccProject/extensions/oops-plugin-framework/assets/libs/animator-effect/2d/FlashSprite.ts"],"names":["Component","Sprite","_decorator","ccclass","property","FlashSprite","duration","_median","_time","_material","onLoad","node","getComponent","getSharedMaterial","setProperty","update","dt","rate","Math","abs","clickFlash"],"mappings":";;;;;;;;;;AAASA,MAAAA,S,OAAAA,S;AAAqBC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,U,OAAAA,U;;;;;;;;;OAChC;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBF,U;;yBAGTG,W,WADpBF,OAAO,CAAC,aAAD,C,gBAAR,MACqBE,WADrB,SACyCL,SADzC,CACmD;AAAA;AAAA;AAAA,eAC/CM,QAD+C,GAC5B,GAD4B;AAAA,eAE/CC,OAF+C,GAE7B,CAF6B;AAAA,eAG/CC,KAH+C,GAG/B,CAH+B;AAAA,eAK/CC,SAL+C,GAKzB,IALyB;AAAA;;AAO/CC,QAAAA,MAAM,GAAG;AACL,eAAKH,OAAL,GAAe,KAAKD,QAAL,GAAgB,CAA/B,CADK,CAEL;;AACA,eAAKG,SAAL,GAAiB,KAAKE,IAAL,CAAUC,YAAV,CAAuBX,MAAvB,EAAgCY,iBAAhC,CAAkD,CAAlD,CAAjB,CAHK,CAIL;;AACA,eAAKJ,SAAL,CAAeK,WAAf,CAA2B,QAA3B,EAAqC,CAArC;AACH;;AAEDC,QAAAA,MAAM,CAACC,EAAD,EAAa;AACf,cAAI,KAAKR,KAAL,GAAa,CAAjB,EAAoB;AAChB,iBAAKA,KAAL,IAAcQ,EAAd;AAEA,iBAAKR,KAAL,GAAa,KAAKA,KAAL,GAAa,CAAb,GAAiB,CAAjB,GAAqB,KAAKA,KAAvC;AACA,gBAAIS,IAAI,GAAGC,IAAI,CAACC,GAAL,CAAS,KAAKX,KAAL,GAAa,KAAKD,OAA3B,IAAsC,CAAtC,GAA0C,KAAKD,QAA1D;;AACA,iBAAKG,SAAL,CAAeK,WAAf,CAA2B,QAA3B,EAAqCG,IAArC;AACH;AACJ;;AAEDG,QAAAA,UAAU,GAAG;AACT,eAAKZ,KAAL,GAAa,KAAKF,QAAlB;AACH;;AA3B8C,O","sourcesContent":["import { Component, Material, Sprite, _decorator } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('FlashSprite')\r\nexport default class FlashSprite extends Component {\r\n    duration: number = 0.5;\r\n    _median: number = 0;\r\n    _time: number = 0;\r\n\r\n    _material: Material = null!;\r\n\r\n    onLoad() {\r\n        this._median = this.duration / 2;\r\n        // 获取材质\r\n        this._material = this.node.getComponent(Sprite)!.getSharedMaterial(0)!;\r\n        // 设置材质对应的属性\r\n        this._material.setProperty(\"u_rate\", 1);\r\n    }\r\n\r\n    update(dt: number) {\r\n        if (this._time > 0) {\r\n            this._time -= dt;\r\n\r\n            this._time = this._time < 0 ? 0 : this._time;\r\n            let rate = Math.abs(this._time - this._median) * 2 / this.duration;\r\n            this._material.setProperty(\"u_rate\", rate);\r\n        }\r\n    }\r\n\r\n    clickFlash() {\r\n        this._time = this.duration;\r\n    }\r\n}\r\n"]}