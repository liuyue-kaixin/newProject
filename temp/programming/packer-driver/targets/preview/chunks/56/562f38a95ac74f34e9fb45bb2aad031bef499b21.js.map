{"version":3,"sources":["file:///Volumes/%E5%9B%BA%E6%80%81/project/extensions/oops-plugin-framework/assets/core/gui/layer/LayerNotify.ts"],"names":["LayerNotify","error","instantiate","oops","Notify","ViewParams","DelegateComponent","LayerUI","ToastPrefabPath","show","content","useI18n","viewParams","uuid","getUuid","prefabPath","params","callbacks","valid","ui_nodes","set","load","res","err","childNode","node","comp","addComponent","createNode","toastCom","getComponent","active","toast"],"mappings":";;;yJAkBaA,W;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAZJC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,W,OAAAA,W;;AACPC,MAAAA,I,iBAAAA,I;;AACAC,MAAAA,M,iBAAAA,M;;AACAC,MAAAA,U,iBAAAA,U;;AACAC,MAAAA,iB,iBAAAA,iB;;AACAC,MAAAA,O,iBAAAA,O;;;;;;AAXT;AACA;AACA;AACA;AACA;AACA;;;;;AAQMC,MAAAA,e,GAA0B,sB;AAEhC;AACA;AACA;;6BACaR,W,GAAN,MAAMA,WAAN;AAAA;AAAA,8BAAkC;AACrC;AACJ;AACA;AACA;AACA;AACIS,QAAAA,IAAI,CAACC,OAAD,EAAkBC,OAAlB,EAA0C;AAC1C,cAAIC,UAAU,GAAG;AAAA;AAAA,yCAAjB;AACAA,UAAAA,UAAU,CAACC,IAAX,GAAkB,KAAKC,OAAL,CAAaN,eAAb,CAAlB;AACAI,UAAAA,UAAU,CAACG,UAAX,GAAwBP,eAAxB;AACAI,UAAAA,UAAU,CAACI,MAAX,GAAoB;AAAEN,YAAAA,OAAO,EAAEA,OAAX;AAAoBC,YAAAA,OAAO,EAAEA;AAA7B,WAApB;AACAC,UAAAA,UAAU,CAACK,SAAX,GAAuB,EAAvB;AACAL,UAAAA,UAAU,CAACM,KAAX,GAAmB,IAAnB;AAEA,eAAKC,QAAL,CAAcC,GAAd,CAAkBR,UAAU,CAACC,IAA7B,EAAmCD,UAAnC;AACA,eAAKS,IAAL,CAAUT,UAAV;AACH;;AAESS,QAAAA,IAAI,CAACT,UAAD,EAAyB;AACnC;AACA;AAAA;AAAA,4BAAKU,GAAL,CAASD,IAAT,CAAcT,UAAU,CAACG,UAAzB,EAAqC,CAACQ,GAAD,EAAoBD,GAApB,KAAoC;AACrE,gBAAIC,GAAJ,EAAS;AACLtB,cAAAA,KAAK,CAACsB,GAAD,CAAL;AACH;;AAED,gBAAIC,SAAe,GAAGtB,WAAW,CAACoB,GAAD,CAAjC;AACAV,YAAAA,UAAU,CAACa,IAAX,GAAkBD,SAAlB;AAEA,gBAAIE,IAAuB,GAAGF,SAAS,CAACG,YAAV;AAAA;AAAA,uDAA9B;AACAD,YAAAA,IAAI,CAACd,UAAL,GAAkBA,UAAlB;AAEA,iBAAKgB,UAAL,CAAgBhB,UAAhB;AACH,WAZD;AAaH;;AAESgB,QAAAA,UAAU,CAAChB,UAAD,EAAyB;AACzC,cAAIY,SAAe,GAAG,MAAMI,UAAN,CAAiBhB,UAAjB,CAAtB;AACA,cAAIiB,QAAQ,GAAGL,SAAS,CAACM,YAAV;AAAA;AAAA,+BAAf;AACAN,UAAAA,SAAS,CAACO,MAAV,GAAmB,IAAnB;AACAF,UAAAA,QAAQ,CAACG,KAAT,CAAepB,UAAU,CAACI,MAAX,CAAkBN,OAAjC,EAA0CE,UAAU,CAACI,MAAX,CAAkBL,OAA5D;AACA,iBAAOa,SAAP;AACH;;AAzCoC,O","sourcesContent":["/*\r\n * @Author: dgflash\r\n * @Date: 2022-08-15 10:06:47\r\n * @LastEditors: dgflash\r\n * @LastEditTime: 2022-09-02 13:44:12\r\n */\r\nimport { error, instantiate, Node, Prefab } from \"cc\";\r\nimport { oops } from \"../../Oops\";\r\nimport { Notify } from \"../prompt/Notify\";\r\nimport { ViewParams } from \"./Defines\";\r\nimport { DelegateComponent } from \"./DelegateComponent\";\r\nimport { LayerUI } from \"./LayerUI\";\r\n\r\nconst ToastPrefabPath: string = 'common/prefab/notify';\r\n\r\n/*\r\n * 滚动消息提示层\r\n */\r\nexport class LayerNotify extends LayerUI {\r\n    /**\r\n     * 显示toast\r\n     * @param content 文本表示\r\n     * @param useI18n 是否使用多语言\r\n     */\r\n    show(content: string, useI18n: boolean): void {\r\n        var viewParams = new ViewParams();\r\n        viewParams.uuid = this.getUuid(ToastPrefabPath);\r\n        viewParams.prefabPath = ToastPrefabPath;\r\n        viewParams.params = { content: content, useI18n: useI18n };\r\n        viewParams.callbacks = {};\r\n        viewParams.valid = true;\r\n\r\n        this.ui_nodes.set(viewParams.uuid, viewParams);\r\n        this.load(viewParams);\r\n    }\r\n\r\n    protected load(viewParams: ViewParams) {\r\n        // 获取预制件资源\r\n        oops.res.load(viewParams.prefabPath, (err: Error | null, res: Prefab) => {\r\n            if (err) {\r\n                error(err);\r\n            }\r\n\r\n            let childNode: Node = instantiate(res);\r\n            viewParams.node = childNode;\r\n\r\n            let comp: DelegateComponent = childNode.addComponent(DelegateComponent);\r\n            comp.viewParams = viewParams;\r\n\r\n            this.createNode(viewParams);\r\n        });\r\n    }\r\n\r\n    protected createNode(viewParams: ViewParams) {\r\n        let childNode: Node = super.createNode(viewParams);\r\n        let toastCom = childNode.getComponent(Notify)!;\r\n        childNode.active = true;\r\n        toastCom.toast(viewParams.params.content, viewParams.params.useI18n);\r\n        return childNode;\r\n    }\r\n}"]}