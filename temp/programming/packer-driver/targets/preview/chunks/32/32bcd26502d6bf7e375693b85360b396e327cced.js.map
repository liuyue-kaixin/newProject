{"version":3,"sources":["file:///Volumes/SSD/ccProject/extensions/oops-plugin-framework/assets/core/gui/layer/LayerManager.ts"],"names":["LayerManager","Camera","Layers","Node","warn","Widget","GUI","DelegateComponent","LayerDialog","LayerNotify","LayerPopUp","LayerUI","UIMap","LayerType","portrait","root","getComponent","init","configs","toast","content","useI18n","notify","show","setConfig","uiId","config","setUIMap","data","uiMap","open","uiArgs","callbacks","layer","UI","ui","add","PopUp","popup","Dialog","dialog","System","system","openAsync","Promise","resolve","reject","onAdded","node","params","has","result","prefab","remove","isDestroy","removeByNode","comp","viewParams","parent","removeByUuid","uuid","destroy","clear","constructor","camera","game","guide","getComponentInChildren","create_node","Game","Notify","Guide","addChild","name","Enum","UI_2D","w","addComponent","isAlignLeft","isAlignRight","isAlignTop","isAlignBottom","left","right","top","bottom","alignMode","enabled"],"mappings":"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","sourcesContent":["import { Camera, Layers, Node, warn, Widget } from \"cc\";\r\nimport { GUI } from \"../GUI\";\r\nimport { UICallbacks } from \"./Defines\";\r\nimport { DelegateComponent } from \"./DelegateComponent\";\r\nimport { LayerDialog } from \"./LayerDialog\";\r\nimport { LayerNotify } from \"./LayerNotify\";\r\nimport { LayerPopUp } from \"./LayerPopup\";\r\nimport { LayerUI } from \"./LayerUI\";\r\nimport { UIMap } from \"./UIMap\";\r\n\r\n/** 界面层类型 */\r\nexport enum LayerType {\r\n    /** 游戏层 */\r\n    Game = \"LayerGame\",\r\n    /** 主界面层 */\r\n    UI = \"LayerUI\",\r\n    /** 弹窗层 */\r\n    PopUp = \"LayerPopUp\",\r\n    /** 模式窗口层 */\r\n    Dialog = \"LayerDialog\",\r\n    /** 系统触发模式窗口层 */\r\n    System = \"LayerSystem\",\r\n    /** 滚动消息提示层 */\r\n    Notify = \"LayerNotify\",\r\n    /** 新手引导层 */\r\n    Guide = \"LayerGuide\"\r\n}\r\n\r\n/** \r\n * 界面配置结构体\r\n * @example\r\n// 界面唯一标识\r\nexport enum UIID {\r\n    Loading = 1,\r\n    Window,\r\n    Netinstable\r\n}\r\n\r\n// 打开界面方式的配置数据\r\nexport var UIConfigData: { [key: number]: UIConfig } = {\r\n    [UIID.Loading]: { layer: LayerType.UI, prefab: \"loading/prefab/loading\", bundle: \"resources\" },\r\n    [UIID.Netinstable]: { layer: LayerType.PopUp, prefab: \"common/prefab/netinstable\" },\r\n    [UIID.Window]: { layer: LayerType.Dialog, prefab: \"common/prefab/window\" }\r\n}\r\n */\r\nexport interface UIConfig {\r\n    /** 远程包名 */\r\n    bundle?: string;\r\n    /** 窗口层级 */\r\n    layer: LayerType;\r\n    /** 预制资源相对路径 */\r\n    prefab: string;\r\n}\r\n\r\nexport class LayerManager {\r\n    /** 界面根节点 */\r\n    root!: Node;\r\n    /** 界面摄像机 */\r\n    camera!: Camera;\r\n    /** 游戏界面特效层 */\r\n    game!: Node;\r\n    /** 新手引导层 */\r\n    guide!: Node;\r\n    /** 界面地图 */\r\n    uiMap!: UIMap;\r\n\r\n    /** 界面层 */\r\n    private ui!: LayerUI;\r\n    /** 弹窗层 */\r\n    private popup!: LayerPopUp;\r\n    /** 只能弹出一个的弹窗 */\r\n    private dialog!: LayerDialog;\r\n    /** 游戏系统提示弹窗  */\r\n    private system!: LayerDialog;\r\n    /** 消息提示控制器，请使用show方法来显示 */\r\n    private notify!: LayerNotify;\r\n    /** UI配置 */\r\n    private configs: { [key: number]: UIConfig } = {};\r\n\r\n    /** 是否为竖屏显示 */\r\n    get portrait() {\r\n        return this.root.getComponent(GUI)!.portrait;\r\n    }\r\n\r\n    /**\r\n     * 初始化所有UI的配置对象\r\n     * @param configs 配置对象\r\n     */\r\n    init(configs: { [key: number]: UIConfig }): void {\r\n        this.configs = configs;\r\n    }\r\n\r\n    /**\r\n     * 渐隐飘过提示\r\n     * @param content 文本表示\r\n     * @param useI18n 是否使用多语言\r\n     * @example \r\n     * oops.gui.toast(\"提示内容\");\r\n     */\r\n    toast(content: string, useI18n: boolean = false) {\r\n        this.notify.show(content, useI18n)\r\n    }\r\n\r\n    /**\r\n     * 设置界面配置\r\n     * @param uiId   要设置的界面id\r\n     * @param config 要设置的配置\r\n     */\r\n    setConfig(uiId: number, config: UIConfig): void {\r\n        this.configs[uiId] = config;\r\n    }\r\n\r\n    /**\r\n     * 设置界面地图配置\r\n     * @param data 界面地图数据\r\n     */\r\n    setUIMap(data: any) {\r\n        if (this.uiMap == null) {\r\n            this.uiMap = new UIMap();\r\n        }\r\n        this.uiMap.init(this, data);\r\n    }\r\n\r\n    /**\r\n     * 同步打开一个窗口\r\n     * @param uiId          窗口唯一编号\r\n     * @param uiArgs        窗口参数\r\n     * @param callbacks     回调对象\r\n     * @example\r\n    var uic: UICallbacks = {\r\n        onAdded: (node: Node, params: any) => {\r\n            var comp = node.getComponent(LoadingViewComp) as ecs.Comp;\r\n        }\r\n        onRemoved:(node: Node | null, params: any) => {\r\n                    \r\n        }\r\n    };\r\n    oops.gui.open(UIID.Loading, null, uic);\r\n     */\r\n    open(uiId: number, uiArgs: any = null, callbacks?: UICallbacks): void {\r\n        var config = this.configs[uiId];\r\n        if (config == null) {\r\n            warn(`打开编号为【${uiId}】的界面失败，配置信息不存在`);\r\n            return;\r\n        }\r\n\r\n        switch (config.layer) {\r\n            case LayerType.UI:\r\n                this.ui.add(config, uiArgs, callbacks);\r\n                break;\r\n            case LayerType.PopUp:\r\n                this.popup.add(config, uiArgs, callbacks);\r\n                break;\r\n            case LayerType.Dialog:\r\n                this.dialog.add(config, uiArgs, callbacks);\r\n                break;\r\n            case LayerType.System:\r\n                this.system.add(config, uiArgs, callbacks);\r\n                break;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 异步打开一个窗口\r\n     * @param uiId          窗口唯一编号\r\n     * @param uiArgs        窗口参数\r\n     * @example \r\n     * var node = await oops.gui.openAsync(UIID.Loading);\r\n     */\r\n    async openAsync(uiId: number, uiArgs: any = null): Promise<Node | null> {\r\n        return new Promise<Node | null>((resolve, reject) => {\r\n            var callbacks: UICallbacks = {\r\n                onAdded: (node: Node, params: any) => {\r\n                    resolve(node)\r\n                }\r\n            };\r\n            this.open(uiId, uiArgs, callbacks);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 缓存中是否存在指定标识的窗口\r\n     * @param uiId 窗口唯一标识\r\n     * @example\r\n     * oops.gui.has(UIID.Loading);\r\n     */\r\n    has(uiId: number): boolean {\r\n        var config = this.configs[uiId];\r\n        if (config == null) {\r\n            warn(`编号为【${uiId}】的界面失败，配置信息不存在`);\r\n            return false;\r\n        }\r\n\r\n        var result = false;\r\n        switch (config.layer) {\r\n            case LayerType.UI:\r\n                result = this.ui.has(config.prefab);\r\n                break;\r\n            case LayerType.PopUp:\r\n                result = this.popup.has(config.prefab);\r\n                break;\r\n            case LayerType.Dialog:\r\n                result = this.dialog.has(config.prefab);\r\n                break;\r\n            case LayerType.System:\r\n                result = this.system.has(config.prefab);\r\n                break;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * 移除指定标识的窗口\r\n     * @param uiId         窗口唯一标识\r\n     * @param isDestroy    移除后是否释放\r\n     * @example\r\n     * oops.gui.remove(UIID.Loading);\r\n     */\r\n    remove(uiId: number, isDestroy: boolean = true) {\r\n        var config = this.configs[uiId];\r\n        if (config == null) {\r\n            warn(`删除编号为【${uiId}】的界面失败，配置信息不存在`);\r\n            return;\r\n        }\r\n\r\n        switch (config.layer) {\r\n            case LayerType.UI:\r\n                this.ui.remove(config.prefab, isDestroy);\r\n                break;\r\n            case LayerType.PopUp:\r\n                this.popup.remove(config.prefab, isDestroy);\r\n                break;\r\n            case LayerType.Dialog:\r\n                this.dialog.remove(config.prefab, isDestroy);\r\n                break;\r\n            case LayerType.System:\r\n                this.system.remove(config.prefab, isDestroy);\r\n                break;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 删除一个通过this框架添加进来的节点\r\n     * @param node          窗口节点\r\n     * @param isDestroy     移除后是否释放\r\n     * @example\r\n     * oops.gui.removeByNode(cc.Node);\r\n     */\r\n    removeByNode(node: Node, isDestroy: boolean = false) {\r\n        if (node instanceof Node) {\r\n            let comp = node.getComponent(DelegateComponent);\r\n            if (comp && comp.viewParams) {\r\n                // @ts-ignore 注：不对外使用\r\n                (node.parent as LayerUI).removeByUuid(comp.viewParams.uuid, isDestroy);\r\n            }\r\n            else {\r\n                warn(`当前删除的node不是通过界面管理器添加到舞台上`);\r\n                node.destroy();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 清除所有窗口\r\n     * @param isDestroy 移除后是否释放\r\n     * @example\r\n     * oops.gui.clear();\r\n     */\r\n    clear(isDestroy: boolean = false) {\r\n        this.ui.clear(isDestroy);\r\n        this.popup.clear(isDestroy);\r\n        this.dialog.clear(isDestroy);\r\n        this.system.clear(isDestroy);\r\n    }\r\n\r\n    /**\r\n     * 构造函数\r\n     * @param root  界面根节点\r\n     */\r\n    constructor(root: Node) {\r\n        this.root = root;\r\n        this.camera = this.root.getComponentInChildren(Camera)!;\r\n\r\n        this.game = this.create_node(LayerType.Game);\r\n\r\n        this.ui = new LayerUI(LayerType.UI);\r\n        this.popup = new LayerPopUp(LayerType.PopUp);\r\n        this.dialog = new LayerDialog(LayerType.Dialog);\r\n        this.system = new LayerDialog(LayerType.System);\r\n        this.notify = new LayerNotify(LayerType.Notify);\r\n\r\n        this.guide = this.create_node(LayerType.Guide);\r\n\r\n        root.addChild(this.game);\r\n        root.addChild(this.ui);\r\n        root.addChild(this.popup);\r\n        root.addChild(this.dialog);\r\n        root.addChild(this.system);\r\n        root.addChild(this.notify);\r\n        root.addChild(this.guide);\r\n    }\r\n\r\n    private create_node(name: string) {\r\n        var node = new Node(name);\r\n        node.layer = Layers.Enum.UI_2D;\r\n        var w: Widget = node.addComponent(Widget);\r\n        w.isAlignLeft = w.isAlignRight = w.isAlignTop = w.isAlignBottom = true;\r\n        w.left = w.right = w.top = w.bottom = 0;\r\n        w.alignMode = 2;\r\n        w.enabled = true;\r\n        return node;\r\n    }\r\n}"]}