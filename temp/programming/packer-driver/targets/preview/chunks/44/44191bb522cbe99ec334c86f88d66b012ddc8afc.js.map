{"version":3,"sources":["file:///Volumes/%E5%9B%BA%E6%80%81/ccProject/extensions/oops-plugin-framework/assets/libs/render-texture/RtToModel.ts"],"names":["Camera","Component","gfx","MeshRenderer","RenderTexture","view","_decorator","ccclass","property","RtToModel","rt","start","size","getVisibleSize","colorAttachment","ColorAttachment","depthStencilAttachment","DepthStencilAttachment","pi","RenderPassInfo","reset","width","height","passInfo","camara","targetTexture","mat","model","material","setProperty","onDestroy","destroy"],"mappings":";;;;;;;;;;;;;;;;AAASA,MAAAA,M,OAAAA,M;AAAQC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,G,OAAAA,G;AAAKC,MAAAA,Y,OAAAA,Y;AAAcC,MAAAA,a,OAAAA,a;AAAeC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,U,OAAAA,U;;;;;;;;;OAC9D;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBF,U;AAE9B;;2BAEaG,S,WADZF,OAAO,CAAC,WAAD,C,UAEHC,QAAQ,CAACR,MAAD,C,UAGRQ,QAAQ,CAACL,YAAD,C,2BALb,MACaM,SADb,SAC+BR,SAD/B,CACyC;AAAA;AAAA;;AAAA;;AAAA;;AAAA,eAO7BS,EAP6B,GAOT,IAAIN,aAAJ,EAPS;AAAA;;AASrCO,QAAAA,KAAK,GAAG;AACJ,cAAMC,IAAI,GAAGP,IAAI,CAACQ,cAAL,EAAb;AACA,cAAMC,eAAe,GAAG,IAAIZ,GAAG,CAACa,eAAR,EAAxB;AACA,cAAMC,sBAAsB,GAAG,IAAId,GAAG,CAACe,sBAAR,EAA/B;AACA,cAAMC,EAAE,GAAG,IAAIhB,GAAG,CAACiB,cAAR,CAAuB,CAACL,eAAD,CAAvB,EAA0CE,sBAA1C,EAAkE,EAAlE,CAAX;AAEA,eAAKN,EAAL,CAAQU,KAAR,CAAc;AACVC,YAAAA,KAAK,EAAET,IAAI,CAACS,KADF;AAEVC,YAAAA,MAAM,EAAEV,IAAI,CAACU,MAFH;AAGVC,YAAAA,QAAQ,EAAEL;AAHA,WAAd;AAMA,eAAKM,MAAL,CAAYC,aAAZ,GAA4B,KAAKf,EAAjC;AACA,cAAMgB,GAAG,GAAG,KAAKC,KAAL,CAAWC,QAAvB;AACAF,UAAAA,GAAG,CAACG,WAAJ,CAAgB,aAAhB,EAA+B,KAAKnB,EAApC;AACH;;AAEDoB,QAAAA,SAAS,GAAG;AACR,eAAKpB,EAAL,CAAQqB,OAAR;AACH;;AA5BoC,O;;;;;iBAEpB,I;;;;;;;iBAGK,I","sourcesContent":["import { Camera, Component, gfx, MeshRenderer, RenderTexture, view, _decorator } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/** 三维摄像机内容显示到模型上 */\r\n@ccclass('RtToModel')\r\nexport class RtToModel extends Component {\r\n    @property(Camera)\r\n    camara: Camera = null!;\r\n\r\n    @property(MeshRenderer)\r\n    model: MeshRenderer = null!;\r\n\r\n    private rt: RenderTexture = new RenderTexture();\r\n\r\n    start() {\r\n        const size = view.getVisibleSize();\r\n        const colorAttachment = new gfx.ColorAttachment();\r\n        const depthStencilAttachment = new gfx.DepthStencilAttachment();\r\n        const pi = new gfx.RenderPassInfo([colorAttachment], depthStencilAttachment, []);\r\n\r\n        this.rt.reset({\r\n            width: size.width,\r\n            height: size.height,\r\n            passInfo: pi\r\n        });\r\n\r\n        this.camara.targetTexture = this.rt;\r\n        const mat = this.model.material!;\r\n        mat.setProperty('mainTexture', this.rt);\r\n    }\r\n\r\n    onDestroy() {\r\n        this.rt.destroy();\r\n    }\r\n}\r\n"]}