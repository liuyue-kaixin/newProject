{"version":3,"sources":["file:///Volumes/SSD/ccProject/node_modules/crypto-es/lib/pad-ansix923.js"],"names":["AnsiX923","pad","data","blockSize","_data","dataSigBytes","sigBytes","blockSizeBytes","nPaddingBytes","lastBytePos","clamp","words","unpad"],"mappings":";;;;;;;AAAA;AACA;AACA;0BACaA,Q,GAAW;AACtBC,QAAAA,GAAG,CAACC,IAAD,EAAOC,SAAP,EAAkB;AACnB,cAAMC,KAAK,GAAGF,IAAd,CADmB,CAGnB;;AACA,cAAMG,YAAY,GAAGD,KAAK,CAACE,QAA3B;AACA,cAAMC,cAAc,GAAGJ,SAAS,GAAG,CAAnC,CALmB,CAOnB;;AACA,cAAMK,aAAa,GAAGD,cAAc,GAAIF,YAAY,GAAGE,cAAvD,CARmB,CAUnB;;AACA,cAAME,WAAW,GAAGJ,YAAY,GAAGG,aAAf,GAA+B,CAAnD,CAXmB,CAanB;;AACAJ,UAAAA,KAAK,CAACM,KAAN;;AACAN,UAAAA,KAAK,CAACO,KAAN,CAAYF,WAAW,KAAK,CAA5B,KAAkCD,aAAa,IAAK,KAAMC,WAAW,GAAG,CAAf,GAAoB,CAA7E;AACAL,UAAAA,KAAK,CAACE,QAAN,IAAkBE,aAAlB;AACD,SAlBqB;;AAoBtBI,QAAAA,KAAK,CAACV,IAAD,EAAO;AACV,cAAME,KAAK,GAAGF,IAAd,CADU,CAGV;;AACA,cAAMM,aAAa,GAAGJ,KAAK,CAACO,KAAN,CAAaP,KAAK,CAACE,QAAN,GAAiB,CAAlB,KAAyB,CAArC,IAA0C,IAAhE,CAJU,CAMV;;AACAF,UAAAA,KAAK,CAACE,QAAN,IAAkBE,aAAlB;AACD;;AA5BqB,O","sourcesContent":["/**\r\n * ANSI X.923 padding strategy.\r\n */\r\nexport const AnsiX923 = {\r\n  pad(data, blockSize) {\r\n    const _data = data;\r\n\r\n    // Shortcuts\r\n    const dataSigBytes = _data.sigBytes;\r\n    const blockSizeBytes = blockSize * 4;\r\n\r\n    // Count padding bytes\r\n    const nPaddingBytes = blockSizeBytes - (dataSigBytes % blockSizeBytes);\r\n\r\n    // Compute last byte position\r\n    const lastBytePos = dataSigBytes + nPaddingBytes - 1;\r\n\r\n    // Pad\r\n    _data.clamp();\r\n    _data.words[lastBytePos >>> 2] |= nPaddingBytes << (24 - (lastBytePos % 4) * 8);\r\n    _data.sigBytes += nPaddingBytes;\r\n  },\r\n\r\n  unpad(data) {\r\n    const _data = data;\r\n\r\n    // Get number of padding bytes from last byte\r\n    const nPaddingBytes = _data.words[(_data.sigBytes - 1) >>> 2] & 0xff;\r\n\r\n    // Remove padding\r\n    _data.sigBytes -= nPaddingBytes;\r\n  },\r\n};\r\n"]}