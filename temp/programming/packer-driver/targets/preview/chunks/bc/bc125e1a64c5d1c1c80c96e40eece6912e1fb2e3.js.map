{"version":3,"sources":["file:///Volumes/%E5%9B%BA%E6%80%81/ccProject/extensions/oops-plugin-framework/assets/libs/gui/language/LanguageSpine.ts"],"names":["CCString","Component","_decorator","sp","EDITOR","oops","LanguageData","ccclass","property","menu","LanguageSpine","serializable","type","_defaultAnimation","dataID","_dataID","value","updateSpine","onLoad","spine","getComponent","Skeleton","animation","start","language","path","current","res","get","SkeletonData","skeletonData","setAnimation","console","error"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAMSA,MAAAA,Q,OAAAA,Q;AAAUC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,U,OAAAA,U;AAAYC,MAAAA,E,OAAAA,E;;AACjCC,MAAAA,M,UAAAA,M;;AACAC,MAAAA,I,iBAAAA,I;;AACAC,MAAAA,Y,iBAAAA,Y;;;;;;AATT;AACA;AACA;AACA;AACA;AACA;;;;;OAMM;AAAEC,QAAAA,OAAF;AAAWC,QAAAA,QAAX;AAAqBC,QAAAA;AAArB,O,GAA8BP,U;;+BAIvBQ,a,WAFZH,OAAO,CAAC,eAAD,C,UACPE,IAAI,CAAC,2BAAD,C,UAEAD,QAAQ,CAAC;AAAEG,QAAAA,YAAY,EAAE;AAAhB,OAAD,C,UAERH,QAAQ,CAAC;AAAEI,QAAAA,IAAI,EAAEZ,QAAR;AAAkBW,QAAAA,YAAY,EAAE;AAAhC,OAAD,C,0CALb,MAEaD,aAFb,SAEmCT,SAFnC,CAE6C;AAAA;AAAA;;AAAA;;AAczC;AAdyC,eAejCY,iBAfiC,GAeL,EAfK;AAAA;;AAI/B,YAANC,MAAM,GAAW;AACjB,iBAAO,KAAKC,OAAL,IAAgB,EAAvB;AACH;;AACS,YAAND,MAAM,CAACE,KAAD,EAAgB;AACtB,eAAKD,OAAL,GAAeC,KAAf;;AACA,cAAI,CAACZ,MAAL,EAAa;AACT,iBAAKa,WAAL;AACH;AACJ;;AAKDC,QAAAA,MAAM,GAAG;AACL,cAAIC,KAAkB,GAAG,KAAKC,YAAL,CAAkBjB,EAAE,CAACkB,QAArB,CAAzB;AACA,eAAKR,iBAAL,GAAyBM,KAAK,CAACG,SAA/B;AACH;;AAEDC,QAAAA,KAAK,GAAG;AACJ,eAAKN,WAAL;AACH;AAED;;;AACAO,QAAAA,QAAQ,GAAG;AACP,eAAKP,WAAL;AACH;;AAEOA,QAAAA,WAAW,GAAG;AAClB;AACA,cAAIQ,IAAI,uBAAqB;AAAA;AAAA,4CAAaC,OAAlC,SAA6C,KAAKZ,MAA1D;AACA,cAAIa,GAA2B,GAAG;AAAA;AAAA,4BAAKA,GAAL,CAASC,GAAT,CAAaH,IAAb,EAAmBtB,EAAE,CAAC0B,YAAtB,CAAlC;;AACA,cAAIF,GAAJ,EAAS;AACL,gBAAIR,KAAkB,GAAG,KAAKC,YAAL,CAAkBjB,EAAE,CAACkB,QAArB,CAAzB;AACAF,YAAAA,KAAK,CAACW,YAAN,GAAqBH,GAArB;AACAR,YAAAA,KAAK,CAACY,YAAN,CAAmB,CAAnB,EAAsB,KAAKlB,iBAA3B,EAA8C,IAA9C;AACH,WAJD,MAKK;AACDmB,YAAAA,OAAO,CAACC,KAAR,CAAc,2BAA2BR,IAAzC;AACH;AACJ;;AA3CwC,O;;;;;iBAEf,E","sourcesContent":["/*\r\n * @Author: dgflash\r\n * @Date: 2023-07-25 10:44:38\r\n * @LastEditors: dgflash\r\n * @LastEditTime: 2023-07-25 11:48:52\r\n */\r\nimport { CCString, Component, _decorator, sp } from \"cc\";\r\nimport { EDITOR } from \"cc/env\";\r\nimport { oops } from \"../../../core/Oops\";\r\nimport { LanguageData } from \"./LanguageData\";\r\n\r\nconst { ccclass, property, menu } = _decorator;\r\n\r\n@ccclass(\"LanguageSpine\")\r\n@menu('ui/language/LanguageSpine')\r\nexport class LanguageSpine extends Component {\r\n    @property({ serializable: true })\r\n    private _dataID: string = \"\";\r\n    @property({ type: CCString, serializable: true })\r\n    get dataID(): string {\r\n        return this._dataID || \"\";\r\n    }\r\n    set dataID(value: string) {\r\n        this._dataID = value;\r\n        if (!EDITOR) {\r\n            this.updateSpine();\r\n        }\r\n    }\r\n\r\n    /** 默认动画名 */\r\n    private _defaultAnimation: string = \"\";\r\n\r\n    onLoad() {\r\n        let spine: sp.Skeleton = this.getComponent(sp.Skeleton)!;\r\n        this._defaultAnimation = spine.animation;\r\n    }\r\n\r\n    start() {\r\n        this.updateSpine();\r\n    }\r\n\r\n    /** 更新语言 */\r\n    language() {\r\n        this.updateSpine();\r\n    }\r\n\r\n    private updateSpine() {\r\n        // 获取语言标记\r\n        let path = `language/spine/${LanguageData.current}/${this.dataID}`;\r\n        let res: sp.SkeletonData | null = oops.res.get(path, sp.SkeletonData);\r\n        if (res) {\r\n            let spine: sp.Skeleton = this.getComponent(sp.Skeleton)!;\r\n            spine.skeletonData = res;\r\n            spine.setAnimation(0, this._defaultAnimation, true);\r\n        }\r\n        else {\r\n            console.error(\"[LanguageSpine] 资源不存在 \" + path);\r\n        }\r\n    }\r\n}"]}