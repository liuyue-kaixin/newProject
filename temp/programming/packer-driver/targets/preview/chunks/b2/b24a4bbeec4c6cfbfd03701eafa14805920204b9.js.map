{"version":3,"sources":["file:///Volumes/SSD/ccProject/extensions/oops-plugin-framework/assets/libs/model-view/VMCompsEdit.ts"],"names":["CCString","Component","Enum","log","Node","_decorator","VMEnv","ccclass","property","executeInEditMode","menu","help","ACTION_MODE","MVCompsEdit","type","tooltip","visible","actionType","SEARCH_COMPONENT","ENABLE_COMPONENT","DELETE_COMPONENT","displayName","allowDelete","REPLACE_WATCH_PATH","readonly","canCollectNodes","findTrigger","v","setComponents","enableTrigger","disableTrigger","deleteTrigger","replaceTrigger","onLoad","editor","path","getNodePath","node","console","error","state","array","findList","title","forEach","name","searchComponent","className","collectNodes","comps","getComponentsInChildren","length","ext","templateMode","watchPathArr","join","watchPath","indexOf","push","enabled","removeComponent","targetPath","replacePath","i","replaceNodePath","search","replace","pathArr","split","searchArr","replaceArr","match","parent","p","getParent","reverse"],"mappings":"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","sourcesContent":["import { CCString, Component, Enum, log, Node, _decorator } from \"cc\";\r\nimport { VMEnv } from \"./VMEnv\";\r\n\r\nconst { ccclass, property, executeInEditMode, menu, help } = _decorator;\r\n\r\nenum ACTION_MODE {\r\n    SEARCH_COMPONENT,\r\n    ENABLE_COMPONENT,\r\n    REPLACE_WATCH_PATH,\r\n    DELETE_COMPONENT\r\n}\r\n\r\n/**\r\n * 用于搜索的MV 组件列表，挂载在父节点后，\r\n * 会遍历搜索下面的所有MV组件, 并且显示其观察值的路径\r\n */\r\n@ccclass\r\n@executeInEditMode\r\n@menu('ModelViewer/Edit-Comps (快速组件操作)')\r\n@help('https://gitee.com/dgflash/oops-framework/blob/master/doc/mvvm/VMCompsEdit.md')\r\nexport default class MVCompsEdit extends Component {\r\n    @property({\r\n        type: [CCString]\r\n    })\r\n    findList: string[] = [\"VMBase\", \"VMParent\"];\r\n\r\n    @property({\r\n        type: Enum(ACTION_MODE)\r\n    })\r\n    actionType: ACTION_MODE = ACTION_MODE.SEARCH_COMPONENT;\r\n\r\n    @property({\r\n        tooltip: '勾选后,会自动查找 find list 中填写的组件',\r\n        visible: function () {\r\n            // @ts-ignore\r\n            return this.actionType === ACTION_MODE.SEARCH_COMPONENT;\r\n        }\r\n    })\r\n    public get findTrigger() {\r\n        return false;\r\n    }\r\n    public set findTrigger(v: boolean) {\r\n        this.setComponents(0);\r\n    }\r\n\r\n    @property({\r\n        tooltip: '勾选后,会批量激活 find list 中填写的组件',\r\n        visible: function () {\r\n            // @ts-ignore\r\n            return this.actionType === ACTION_MODE.ENABLE_COMPONENT;\r\n        }\r\n    })\r\n    public get enableTrigger() {\r\n        return false;\r\n    }\r\n    public set enableTrigger(v: boolean) {\r\n        this.setComponents(1);\r\n    }\r\n\r\n    @property({\r\n        tooltip: '勾选后,会批量关闭 find list 中填写的组件',\r\n        visible: function () {\r\n            // @ts-ignore\r\n            return this.actionType === ACTION_MODE.ENABLE_COMPONENT;\r\n        }\r\n    })\r\n    public get disableTrigger() {\r\n        return false;\r\n    }\r\n    public set disableTrigger(v: boolean) {\r\n        this.setComponents(2);\r\n    }\r\n\r\n    @property({\r\n        tooltip: '允许删除节点的组件,确定需要移除请勾选,防止误操作',\r\n        visible: function () {\r\n            // @ts-ignore\r\n            return this.actionType === ACTION_MODE.DELETE_COMPONENT;\r\n        }\r\n    })\r\n    allowDelete: boolean = false;\r\n\r\n    @property({\r\n        tooltip: '勾选后,会批量删除 find list 中填写的组件',\r\n        displayName: '[ X DELETE X ]',\r\n        visible: function () {\r\n            // @ts-ignore\r\n            return this.allowDelete && this.actionType === ACTION_MODE.DELETE_COMPONENT;\r\n        }\r\n    })\r\n    public get deleteTrigger() {\r\n        return false;\r\n    }\r\n    public set deleteTrigger(v: boolean) {\r\n        this.setComponents(3);\r\n    }\r\n\r\n    @property({\r\n        tooltip: '勾选后,会批量替换掉指定的路径',\r\n        visible: function () {\r\n            // @ts-ignore\r\n            return this.actionType === ACTION_MODE.REPLACE_WATCH_PATH;\r\n        }\r\n    })\r\n    public get replaceTrigger() {\r\n        return false;\r\n    }\r\n    public set replaceTrigger(v: boolean) {\r\n        this.setComponents(4);\r\n    }\r\n\r\n    @property({\r\n        tooltip: '匹配的路径,匹配规则: 搜索开头为 game的路径',\r\n        visible: function () {\r\n            // @ts-ignore\r\n            return this.actionType === ACTION_MODE.REPLACE_WATCH_PATH;\r\n        }\r\n    })\r\n    targetPath: string = 'game';\r\n\r\n    @property({\r\n        tooltip: '替换的路径,将匹配到的路径替换',\r\n        visible: function () {\r\n            // @ts-ignore\r\n            return this.actionType === ACTION_MODE.REPLACE_WATCH_PATH;\r\n        }\r\n    })\r\n    replacePath: string = '*';\r\n\r\n\r\n    @property({\r\n        tooltip: '是否搜集绑定VM组件的节点?',\r\n        visible: function () {\r\n            // @ts-ignore\r\n            return this.actionType === ACTION_MODE.SEARCH_COMPONENT;\r\n        }\r\n    })\r\n    canCollectNodes: boolean = false;\r\n\r\n    @property({\r\n        type: [Node],\r\n        readonly: true,\r\n        tooltip: '收集到绑定了VM组件相关的节点，可以自己跳转过去',\r\n        visible: function () {\r\n            // @ts-ignore\r\n            return this.canCollectNodes && this.actionType === ACTION_MODE.SEARCH_COMPONENT\r\n        }\r\n    })\r\n    collectNodes: Node[] = [];\r\n\r\n    onLoad() {\r\n        if (VMEnv.editor) return;\r\n\r\n        let path = this.getNodePath(this.node);\r\n        console.error('you forget delete MVEditFinder,[path]', path);\r\n    }\r\n\r\n    setComponents(state: number) {\r\n        let array = this.findList;\r\n        let title = '搜索到当前节点下面的组件';\r\n        switch (state) {\r\n            case 0: title = '搜索到当前节点下面的组件'; break;\r\n            case 1: title = '激活以下节点的组件'; break;\r\n            case 2: title = '关闭以下节点的组件'; break;\r\n            case 3: title = '删除以下节点的组件'; break;\r\n            case 4: title = '替换以下节点的路径'; break;\r\n\r\n            default:\r\n                break;\r\n        }\r\n        log(title)\r\n        log('______________________')\r\n\r\n        array.forEach(name => {\r\n            this.searchComponent(name, state)\r\n        })\r\n\r\n        log('______________________')\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param className \r\n     * @param state 0-查找节点组件 1-激活节点组件 2-关闭节点组件 3-移除节点组件\r\n     */\r\n    searchComponent(className: string, state: number = 0) {\r\n        /**收集节点清空 */\r\n        this.collectNodes = [];\r\n\r\n        let comps = this.node.getComponentsInChildren(className);\r\n        if (comps == null || comps.length < 1) return;\r\n        log('[' + className + ']:');\r\n        comps.forEach((v: any) => {\r\n            let ext = '';\r\n\r\n            if (state <= 3) {\r\n                //区分模板模式路径\r\n                if (v.templateMode === true) {\r\n                    ext = v.watchPathArr ? ':[Path:' + v.watchPathArr.join('|') + ']' : ''\r\n                }\r\n                else {\r\n                    ext = v.watchPath ? ':[Path:' + v.watchPath + ']' : ''\r\n                }\r\n            }\r\n\r\n            log(this.getNodePath(v.node) + ext);\r\n            switch (state) {\r\n                case 0://寻找组件\r\n                    if (this.canCollectNodes) {\r\n                        if (this.collectNodes.indexOf(v.node) === -1) {\r\n                            this.collectNodes.push(v.node);\r\n                        }\r\n                    }\r\n                    break;\r\n                case 1:         // 激活组件\r\n                    v.enabled = true;\r\n                    break;\r\n                case 2:         // 关闭组件\r\n                    v.enabled = false;\r\n                    break;\r\n                case 3:         // 删除组件\r\n                    v.node.removeComponent(v);\r\n                    break;\r\n                case 4:         // 替换指定路径\r\n                    let targetPath = this.targetPath;\r\n                    let replacePath = this.replacePath;\r\n                    if (v.templateMode === true) {\r\n                        for (let i = 0; i < v.watchPathArr.length; i++) {\r\n                            const path = v.watchPathArr[i];\r\n                            v.watchPathArr[i] = this.replaceNodePath(path, targetPath, replacePath);\r\n                        }\r\n                    }\r\n                    else {\r\n                        v.watchPath = this.replaceNodePath(v.watchPath, targetPath, replacePath);\r\n                    }\r\n\r\n\r\n                default:\r\n                    break;\r\n            }\r\n        });\r\n    }\r\n\r\n    replaceNodePath(path: string, search: string, replace: string) {\r\n        let pathArr = path.split('.');\r\n        let searchArr = search.split('.');\r\n        let replaceArr = replace.split('.')\r\n\r\n        let match = true;\r\n        for (let i = 0; i < searchArr.length; i++) {\r\n            //未匹配上\r\n            if (pathArr[i] !== searchArr[i]) {\r\n                match = false;\r\n                break;\r\n            }\r\n\r\n        }\r\n\r\n        //匹配成功准备替换路径\r\n        if (match === true) {\r\n            for (let i = 0; i < replaceArr.length; i++) {\r\n                pathArr[i] = replaceArr[i];\r\n            }\r\n            log(' 路径更新:', path, '>>>', pathArr.join('.'))\r\n        }\r\n\r\n        return pathArr.join('.');\r\n    }\r\n\r\n    getNodePath(node: Node) {\r\n        let parent = node;\r\n        let array = [];\r\n        while (parent) {\r\n            let p = parent.getParent();\r\n            if (p) {\r\n                array.push(parent.name);\r\n                parent = p;\r\n            }\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n        return array.reverse().join('/');\r\n    }\r\n}\r\n"]}