{"version":3,"sources":["file:///Volumes/SSD%201/ccProject/extensions/oops-plugin-framework/assets/core/game/GameManager.ts"],"names":["GameManager","game","Game","timeScale","constructor","root","gameTimeScaleExtend","setTimeScale","scale","_calculateDT","now","performance","_deltaTime","_startTime","DEBUG_DT_THRESHOLD","frameTime"],"mappings":";;;8EAWaA,W;;;;;;;;;AALJC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,I,OAAAA,I;;;;;;AANf;AACA;AACA;AACA;AACA;AACA;;;;;AAGIC,MAAAA,S,GAAY,C;AAEhB;;6BACaH,W,GAAN,MAAMA,WAAN,CAAkB;AAIrBI,QAAAA,WAAW,CAACC,IAAD,EAAa;AAHxB;AAGwB,eAFxBA,IAEwB;AACpB,eAAKA,IAAL,GAAYA,IAAZ;AACA,eAAKC,mBAAL;AACH;AAED;;;AACAC,QAAAA,YAAY,CAACC,KAAD,EAAgB;AACxBL,UAAAA,SAAS,GAAGK,KAAZ;AACH;AAED;;;AACQF,QAAAA,mBAAmB,GAAG;AAC1B;AACAL,UAAAA,IAAI,CAACQ,YAAL,GAAoB,UAAUC,GAAV,EAAuB;AACvC,gBAAI,CAACA,GAAL,EAAUA,GAAG,GAAGC,WAAW,CAACD,GAAZ,EAAN,CAD6B,CAEvC;;AACA,iBAAKE,UAAL,GAAkBF,GAAG,GAAG,KAAKG,UAAX,GAAwB,CAACH,GAAG,GAAG,KAAKG,UAAZ,IAA0B,IAAlD,GAAyD,CAA3E,CAHuC,CAIvC;;AACA,gBAAI,KAAKD,UAAL,GAAkBV,IAAI,CAACY,kBAA3B,EAA+C;AAC3C;AACA,mBAAKF,UAAL,GAAkB,KAAKG,SAAL,GAAiB,IAAnC;AACH,aARsC,CASvC;;;AACA,iBAAKF,UAAL,GAAkBH,GAAlB,CAVuC,CAWvC;;AACA,mBAAO,KAAKE,UAAL,GAAkBT,SAAzB;AACH,WAbD;AAcH;;AA/BoB,O","sourcesContent":["/*\r\n * @Author: dgflash\r\n * @Date: 2022-02-10 09:50:41\r\n * @LastEditors: dgflash\r\n * @LastEditTime: 2022-09-02 12:09:55\r\n */\r\nimport { game, Game, Node } from 'cc';\r\n\r\nvar timeScale = 1;\r\n\r\n/** 游戏世界管理 */\r\nexport class GameManager {\r\n    /** 界面根节点 */\r\n    root!: Node;\r\n\r\n    constructor(root: Node) {\r\n        this.root = root;\r\n        this.gameTimeScaleExtend();\r\n    }\r\n\r\n    /** 设置游戏动画速度（不支持 Native 模式） */\r\n    setTimeScale(scale: number) {\r\n        timeScale = scale;\r\n    }\r\n\r\n    /** 只支持web整体加速 */\r\n    private gameTimeScaleExtend() {\r\n        //@ts-ignore\r\n        game._calculateDT = function (now: number) {\r\n            if (!now) now = performance.now();\r\n            //@ts-ignore\r\n            this._deltaTime = now > this._startTime ? (now - this._startTime) / 1000 : 0;\r\n            //@ts-ignore\r\n            if (this._deltaTime > Game.DEBUG_DT_THRESHOLD) {\r\n                //@ts-ignore\r\n                this._deltaTime = this.frameTime / 1000;\r\n            }\r\n            //@ts-ignore\r\n            this._startTime = now;\r\n            //@ts-ignore\r\n            return this._deltaTime * timeScale;\r\n        };\r\n    }\r\n}\r\n"]}