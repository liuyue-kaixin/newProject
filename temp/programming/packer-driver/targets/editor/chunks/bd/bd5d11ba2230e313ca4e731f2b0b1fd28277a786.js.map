{"version":3,"sources":["file:///Volumes/SSD/ccProject/extensions/oops-plugin-framework/assets/libs/gui/button/ButtonSimple.ts"],"names":["Component","game","Node","_decorator","ccclass","property","menu","ButtonSimple","tooltip","touchCount","touchtEndTime","onLoad","node","on","EventType","TOUCH_START","onTouchtStart","TOUCH_END","onTouchEnd","TOUCH_CANCEL","event","once","propagationStopped","totalTime","interval","onDestroy","off"],"mappings":";;;;;;;;;;;;;;;;AAASA,MAAAA,S,OAAAA,S;AAAuBC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,U,OAAAA,U;;;;;;;;;OAEtC;AAAEC,QAAAA,OAAF;AAAWC,QAAAA,QAAX;AAAqBC,QAAAA;AAArB,O,GAA8BH,U;;yBAIfI,Y,WAFpBH,OAAO,CAAC,cAAD,C,UACPE,IAAI,CAAC,wBAAD,C,UAEAD,QAAQ,CAAC;AACNG,QAAAA,OAAO,EAAE;AADH,OAAD,C,UAKRH,QAAQ,CAAC;AACNG,QAAAA,OAAO,EAAE;AADH,OAAD,C,0CARb,MAEqBD,YAFrB,SAE0CP,SAF1C,CAEoD;AAAA;AAAA;;AAAA;;AAAA;;AAAA,eAWxCS,UAXwC,GAW3B,CAX2B;AAAA,eAYxCC,aAZwC,GAYxB,CAZwB;AAAA;;AAchDC,QAAAA,MAAM,GAAG;AACL,eAAKC,IAAL,CAAUC,EAAV,CAAaX,IAAI,CAACY,SAAL,CAAeC,WAA5B,EAAyC,KAAKC,aAA9C,EAA6D,IAA7D;AACA,eAAKJ,IAAL,CAAUC,EAAV,CAAaX,IAAI,CAACY,SAAL,CAAeG,SAA5B,EAAuC,KAAKC,UAA5C,EAAwD,IAAxD;AACA,eAAKN,IAAL,CAAUC,EAAV,CAAaX,IAAI,CAACY,SAAL,CAAeK,YAA5B,EAA0C,KAAKD,UAA/C,EAA2D,IAA3D;AACH;AAED;;;AACUF,QAAAA,aAAa,CAACI,KAAD,EAAoB,CAAG;AAE9C;;;AACUF,QAAAA,UAAU,CAACE,KAAD,EAAoB;AACpC,cAAI,KAAKC,IAAT,EAAe;AACX,gBAAI,KAAKZ,UAAL,GAAkB,CAAtB,EAAyB;AACrBW,cAAAA,KAAK,CAACE,kBAAN,GAA2B,IAA3B;AACA;AACH;;AACD,iBAAKb,UAAL;AACH,WAPmC,CASpC;;;AACA,cAAI,KAAKC,aAAL,IAAsBT,IAAI,CAACsB,SAAL,GAAiB,KAAKb,aAAtB,GAAsC,KAAKc,QAArE,EAA+E;AAC3EJ,YAAAA,KAAK,CAACE,kBAAN,GAA2B,IAA3B;AACH,WAFD,MAGK;AACD,iBAAKZ,aAAL,GAAqBT,IAAI,CAACsB,SAA1B;AACH;AACJ;;AAEDE,QAAAA,SAAS,GAAG;AACR,eAAKb,IAAL,CAAUc,GAAV,CAAcxB,IAAI,CAACY,SAAL,CAAeC,WAA7B,EAA0C,KAAKC,aAA/C,EAA8D,IAA9D;AACA,eAAKJ,IAAL,CAAUc,GAAV,CAAcxB,IAAI,CAACY,SAAL,CAAeG,SAA7B,EAAwC,KAAKC,UAA7C,EAAyD,IAAzD;AACA,eAAKN,IAAL,CAAUc,GAAV,CAAcxB,IAAI,CAACY,SAAL,CAAeK,YAA7B,EAA2C,KAAKD,UAAhD,EAA4D,IAA5D;AACH;;AA9C+C,O;;;;;iBAIxB,K;;;;;;;iBAKG,G","sourcesContent":["import { Component, EventTouch, game, Node, _decorator } from \"cc\";\r\n\r\nconst { ccclass, property, menu } = _decorator;\r\n\r\n@ccclass(\"ButtonSimple\")\r\n@menu('ui/button/ButtonSimple')\r\nexport default class ButtonSimple extends Component {\r\n    @property({\r\n        tooltip: \"是否只能触发一次\"\r\n    })\r\n    private once: boolean = false;\r\n\r\n    @property({\r\n        tooltip: \"每次触发间隔\"\r\n    })\r\n    private interval: number = 500;\r\n\r\n    private touchCount = 0;\r\n    private touchtEndTime = 0;\r\n\r\n    onLoad() {\r\n        this.node.on(Node.EventType.TOUCH_START, this.onTouchtStart, this);\r\n        this.node.on(Node.EventType.TOUCH_END, this.onTouchEnd, this);\r\n        this.node.on(Node.EventType.TOUCH_CANCEL, this.onTouchEnd, this);\r\n    }\r\n\r\n    /** 触摸开始 */\r\n    protected onTouchtStart(event: EventTouch) { }\r\n\r\n    /** 触摸结束 */\r\n    protected onTouchEnd(event: EventTouch) {\r\n        if (this.once) {\r\n            if (this.touchCount > 0) {\r\n                event.propagationStopped = true;\r\n                return;\r\n            }\r\n            this.touchCount++;\r\n        }\r\n\r\n        // 防连点500毫秒出发一次事件\r\n        if (this.touchtEndTime && game.totalTime - this.touchtEndTime < this.interval) {\r\n            event.propagationStopped = true;\r\n        }\r\n        else {\r\n            this.touchtEndTime = game.totalTime;\r\n        }\r\n    }\r\n\r\n    onDestroy() {\r\n        this.node.off(Node.EventType.TOUCH_START, this.onTouchtStart, this);\r\n        this.node.off(Node.EventType.TOUCH_END, this.onTouchEnd, this);\r\n        this.node.off(Node.EventType.TOUCH_CANCEL, this.onTouchEnd, this);\r\n    }\r\n}\r\n"]}