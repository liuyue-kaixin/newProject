{"version":3,"sources":["file:///Volumes/%E5%9B%BA%E6%80%81/project/node_modules/crypto-es/lib/sha256.js"],"names":["SHA256Algo","WordArray","Hasher","H","K","isPrime","n","sqrtN","Math","sqrt","factor","getFractionalBits","nPrime","W","_doReset","_hash","slice","_doProcessBlock","M","offset","_H","words","a","b","c","d","e","f","g","h","i","gamma0x","gamma0","gamma1x","gamma1","ch","maj","sigma0","sigma1","t1","t2","_doFinalize","data","_data","dataWords","nBitsTotal","_nDataBytes","nBitsLeft","sigBytes","floor","length","_process","clone","call","SHA256","_createHelper","HmacSHA256","_createHmacHelper"],"mappings":";;;yBA4CaA,U;;;;;;AA3CXC,MAAAA,S,gBAAAA,S;AACAC,MAAAA,M,gBAAAA,M;;;AAGF;AACMC,MAAAA,C,GAAI,E;AACJC,MAAAA,C,GAAI,E,EAEV;;AACMC,MAAAA,O,GAAWC,CAAD,IAAO;AACrB,cAAMC,KAAK,GAAGC,IAAI,CAACC,IAAL,CAAUH,CAAV,CAAd;;AACA,aAAK,IAAII,MAAM,GAAG,CAAlB,EAAqBA,MAAM,IAAIH,KAA/B,EAAsCG,MAAM,IAAI,CAAhD,EAAmD;AACjD,cAAI,EAAEJ,CAAC,GAAGI,MAAN,CAAJ,EAAmB;AACjB,mBAAO,KAAP;AACD;AACF;;AAED,eAAO,IAAP;AACD,O;;AAEKC,MAAAA,iB,GAAoBL,CAAC,IAAK,CAACA,CAAC,IAAIA,CAAC,GAAG,CAAR,CAAF,IAAgB,WAAjB,GAAgC,C;;AAE3DA,MAAAA,C,GAAI,C;AACJM,MAAAA,M,GAAS,C;;AACb,aAAOA,MAAM,GAAG,EAAhB,EAAoB;AAClB,YAAIP,OAAO,CAACC,CAAD,CAAX,EAAgB;AACd,cAAIM,MAAM,GAAG,CAAb,EAAgB;AACdT,YAAAA,CAAC,CAACS,MAAD,CAAD,GAAYD,iBAAiB,CAACL,CAAC,KAAK,IAAI,CAAT,CAAF,CAA7B;AACD;;AACDF,UAAAA,CAAC,CAACQ,MAAD,CAAD,GAAYD,iBAAiB,CAACL,CAAC,KAAK,IAAI,CAAT,CAAF,CAA7B;AAEAM,UAAAA,MAAM,IAAI,CAAV;AACD;;AAEDN,QAAAA,CAAC,IAAI,CAAL;AACD,O,CAED;;;AACMO,MAAAA,C,GAAI,E;AAEV;AACA;AACA;;4BACab,U,GAAN,MAAMA,UAAN,SAAyBE,MAAzB,CAAgC;AACrCY,QAAAA,QAAQ,GAAG;AACT,eAAKC,KAAL,GAAa,IAAId,SAAJ,CAAcE,CAAC,CAACa,KAAF,CAAQ,CAAR,CAAd,CAAb;AACD;;AAEDC,QAAAA,eAAe,CAACC,CAAD,EAAIC,MAAJ,EAAY;AACzB;AACA,gBAAMC,EAAE,GAAG,KAAKL,KAAL,CAAWM,KAAtB,CAFyB,CAIzB;;AACA,cAAIC,CAAC,GAAGF,EAAE,CAAC,CAAD,CAAV;AACA,cAAIG,CAAC,GAAGH,EAAE,CAAC,CAAD,CAAV;AACA,cAAII,CAAC,GAAGJ,EAAE,CAAC,CAAD,CAAV;AACA,cAAIK,CAAC,GAAGL,EAAE,CAAC,CAAD,CAAV;AACA,cAAIM,CAAC,GAAGN,EAAE,CAAC,CAAD,CAAV;AACA,cAAIO,CAAC,GAAGP,EAAE,CAAC,CAAD,CAAV;AACA,cAAIQ,CAAC,GAAGR,EAAE,CAAC,CAAD,CAAV;AACA,cAAIS,CAAC,GAAGT,EAAE,CAAC,CAAD,CAAV,CAZyB,CAczB;;AACA,eAAK,IAAIU,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,EAApB,EAAwBA,CAAC,IAAI,CAA7B,EAAgC;AAC9B,gBAAIA,CAAC,GAAG,EAAR,EAAY;AACVjB,cAAAA,CAAC,CAACiB,CAAD,CAAD,GAAOZ,CAAC,CAACC,MAAM,GAAGW,CAAV,CAAD,GAAgB,CAAvB;AACD,aAFD,MAEO;AACL,oBAAMC,OAAO,GAAGlB,CAAC,CAACiB,CAAC,GAAG,EAAL,CAAjB;AACA,oBAAME,MAAM,GAAG,CAAED,OAAO,IAAI,EAAZ,GAAmBA,OAAO,KAAK,CAAhC,KACTA,OAAO,IAAI,EAAZ,GAAmBA,OAAO,KAAK,EADrB,IAEVA,OAAO,KAAK,CAFjB;AAIA,oBAAME,OAAO,GAAGpB,CAAC,CAACiB,CAAC,GAAG,CAAL,CAAjB;AACA,oBAAMI,MAAM,GAAG,CAAED,OAAO,IAAI,EAAZ,GAAmBA,OAAO,KAAK,EAAhC,KACTA,OAAO,IAAI,EAAZ,GAAmBA,OAAO,KAAK,EADrB,IAEVA,OAAO,KAAK,EAFjB;AAIApB,cAAAA,CAAC,CAACiB,CAAD,CAAD,GAAOE,MAAM,GAAGnB,CAAC,CAACiB,CAAC,GAAG,CAAL,CAAV,GAAoBI,MAApB,GAA6BrB,CAAC,CAACiB,CAAC,GAAG,EAAL,CAArC;AACD;;AAED,kBAAMK,EAAE,GAAIT,CAAC,GAAGC,CAAL,GAAW,CAACD,CAAD,GAAKE,CAA3B;AACA,kBAAMQ,GAAG,GAAId,CAAC,GAAGC,CAAL,GAAWD,CAAC,GAAGE,CAAf,GAAqBD,CAAC,GAAGC,CAArC;AAEA,kBAAMa,MAAM,GAAG,CAAEf,CAAC,IAAI,EAAN,GAAaA,CAAC,KAAK,CAApB,KAA4BA,CAAC,IAAI,EAAN,GAAaA,CAAC,KAAK,EAA9C,KAAuDA,CAAC,IAAI,EAAN,GAAaA,CAAC,KAAK,EAAzE,CAAf;AACA,kBAAMgB,MAAM,GAAG,CAAEZ,CAAC,IAAI,EAAN,GAAaA,CAAC,KAAK,CAApB,KAA4BA,CAAC,IAAI,EAAN,GAAaA,CAAC,KAAK,EAA9C,KAAuDA,CAAC,IAAI,CAAN,GAAYA,CAAC,KAAK,EAAxE,CAAf;AAEA,kBAAMa,EAAE,GAAGV,CAAC,GAAGS,MAAJ,GAAaH,EAAb,GAAkB/B,CAAC,CAAC0B,CAAD,CAAnB,GAAyBjB,CAAC,CAACiB,CAAD,CAArC;AACA,kBAAMU,EAAE,GAAGH,MAAM,GAAGD,GAApB;AAEAP,YAAAA,CAAC,GAAGD,CAAJ;AACAA,YAAAA,CAAC,GAAGD,CAAJ;AACAA,YAAAA,CAAC,GAAGD,CAAJ;AACAA,YAAAA,CAAC,GAAID,CAAC,GAAGc,EAAL,GAAW,CAAf;AACAd,YAAAA,CAAC,GAAGD,CAAJ;AACAA,YAAAA,CAAC,GAAGD,CAAJ;AACAA,YAAAA,CAAC,GAAGD,CAAJ;AACAA,YAAAA,CAAC,GAAIiB,EAAE,GAAGC,EAAN,GAAY,CAAhB;AACD,WAjDwB,CAmDzB;;;AACApB,UAAAA,EAAE,CAAC,CAAD,CAAF,GAASA,EAAE,CAAC,CAAD,CAAF,GAAQE,CAAT,GAAc,CAAtB;AACAF,UAAAA,EAAE,CAAC,CAAD,CAAF,GAASA,EAAE,CAAC,CAAD,CAAF,GAAQG,CAAT,GAAc,CAAtB;AACAH,UAAAA,EAAE,CAAC,CAAD,CAAF,GAASA,EAAE,CAAC,CAAD,CAAF,GAAQI,CAAT,GAAc,CAAtB;AACAJ,UAAAA,EAAE,CAAC,CAAD,CAAF,GAASA,EAAE,CAAC,CAAD,CAAF,GAAQK,CAAT,GAAc,CAAtB;AACAL,UAAAA,EAAE,CAAC,CAAD,CAAF,GAASA,EAAE,CAAC,CAAD,CAAF,GAAQM,CAAT,GAAc,CAAtB;AACAN,UAAAA,EAAE,CAAC,CAAD,CAAF,GAASA,EAAE,CAAC,CAAD,CAAF,GAAQO,CAAT,GAAc,CAAtB;AACAP,UAAAA,EAAE,CAAC,CAAD,CAAF,GAASA,EAAE,CAAC,CAAD,CAAF,GAAQQ,CAAT,GAAc,CAAtB;AACAR,UAAAA,EAAE,CAAC,CAAD,CAAF,GAASA,EAAE,CAAC,CAAD,CAAF,GAAQS,CAAT,GAAc,CAAtB;AACD;;AAEDY,QAAAA,WAAW,GAAG;AACZ;AACA,gBAAMC,IAAI,GAAG,KAAKC,KAAlB;AACA,gBAAMC,SAAS,GAAGF,IAAI,CAACrB,KAAvB;AAEA,gBAAMwB,UAAU,GAAG,KAAKC,WAAL,GAAmB,CAAtC;AACA,gBAAMC,SAAS,GAAGL,IAAI,CAACM,QAAL,GAAgB,CAAlC,CANY,CAQZ;;AACAJ,UAAAA,SAAS,CAACG,SAAS,KAAK,CAAf,CAAT,IAA8B,QAAS,KAAMA,SAAS,GAAG,EAAzD;AACAH,UAAAA,SAAS,CAAC,CAAGG,SAAS,GAAG,EAAb,KAAqB,CAAtB,IAA4B,CAA7B,IAAkC,EAAnC,CAAT,GAAkDvC,IAAI,CAACyC,KAAL,CAAWJ,UAAU,GAAG,WAAxB,CAAlD;AACAD,UAAAA,SAAS,CAAC,CAAGG,SAAS,GAAG,EAAb,KAAqB,CAAtB,IAA4B,CAA7B,IAAkC,EAAnC,CAAT,GAAkDF,UAAlD;AACAH,UAAAA,IAAI,CAACM,QAAL,GAAgBJ,SAAS,CAACM,MAAV,GAAmB,CAAnC,CAZY,CAcZ;;AACA,eAAKC,QAAL,GAfY,CAiBZ;;;AACA,iBAAO,KAAKpC,KAAZ;AACD;;AAEDqC,QAAAA,KAAK,GAAG;AACN,gBAAMA,KAAK,GAAG,MAAMA,KAAN,CAAYC,IAAZ,CAAiB,IAAjB,CAAd;AACAD,UAAAA,KAAK,CAACrC,KAAN,GAAc,KAAKA,KAAL,CAAWqC,KAAX,EAAd;AAEA,iBAAOA,KAAP;AACD;;AA7FoC,O;AAgGvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;wBACaE,M,GAASpD,MAAM,CAACqD,aAAP,CAAqBvD,UAArB,C;AAEtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;4BACawD,U,GAAatD,MAAM,CAACuD,iBAAP,CAAyBzD,UAAzB,C","sourcesContent":["import {\r\n  WordArray,\r\n  Hasher,\r\n} from './core.js';\r\n\r\n// Initialization and round constants tables\r\nconst H = [];\r\nconst K = [];\r\n\r\n// Compute constants\r\nconst isPrime = (n) => {\r\n  const sqrtN = Math.sqrt(n);\r\n  for (let factor = 2; factor <= sqrtN; factor += 1) {\r\n    if (!(n % factor)) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nconst getFractionalBits = n => ((n - (n | 0)) * 0x100000000) | 0;\r\n\r\nlet n = 2;\r\nlet nPrime = 0;\r\nwhile (nPrime < 64) {\r\n  if (isPrime(n)) {\r\n    if (nPrime < 8) {\r\n      H[nPrime] = getFractionalBits(n ** (1 / 2));\r\n    }\r\n    K[nPrime] = getFractionalBits(n ** (1 / 3));\r\n\r\n    nPrime += 1;\r\n  }\r\n\r\n  n += 1;\r\n}\r\n\r\n// Reusable object\r\nconst W = [];\r\n\r\n/**\r\n * SHA-256 hash algorithm.\r\n */\r\nexport class SHA256Algo extends Hasher {\r\n  _doReset() {\r\n    this._hash = new WordArray(H.slice(0));\r\n  }\r\n\r\n  _doProcessBlock(M, offset) {\r\n    // Shortcut\r\n    const _H = this._hash.words;\r\n\r\n    // Working variables\r\n    let a = _H[0];\r\n    let b = _H[1];\r\n    let c = _H[2];\r\n    let d = _H[3];\r\n    let e = _H[4];\r\n    let f = _H[5];\r\n    let g = _H[6];\r\n    let h = _H[7];\r\n\r\n    // Computation\r\n    for (let i = 0; i < 64; i += 1) {\r\n      if (i < 16) {\r\n        W[i] = M[offset + i] | 0;\r\n      } else {\r\n        const gamma0x = W[i - 15];\r\n        const gamma0 = ((gamma0x << 25) | (gamma0x >>> 7))\r\n          ^ ((gamma0x << 14) | (gamma0x >>> 18))\r\n          ^ (gamma0x >>> 3);\r\n\r\n        const gamma1x = W[i - 2];\r\n        const gamma1 = ((gamma1x << 15) | (gamma1x >>> 17))\r\n          ^ ((gamma1x << 13) | (gamma1x >>> 19))\r\n          ^ (gamma1x >>> 10);\r\n\r\n        W[i] = gamma0 + W[i - 7] + gamma1 + W[i - 16];\r\n      }\r\n\r\n      const ch = (e & f) ^ (~e & g);\r\n      const maj = (a & b) ^ (a & c) ^ (b & c);\r\n\r\n      const sigma0 = ((a << 30) | (a >>> 2)) ^ ((a << 19) | (a >>> 13)) ^ ((a << 10) | (a >>> 22));\r\n      const sigma1 = ((e << 26) | (e >>> 6)) ^ ((e << 21) | (e >>> 11)) ^ ((e << 7) | (e >>> 25));\r\n\r\n      const t1 = h + sigma1 + ch + K[i] + W[i];\r\n      const t2 = sigma0 + maj;\r\n\r\n      h = g;\r\n      g = f;\r\n      f = e;\r\n      e = (d + t1) | 0;\r\n      d = c;\r\n      c = b;\r\n      b = a;\r\n      a = (t1 + t2) | 0;\r\n    }\r\n\r\n    // Intermediate hash value\r\n    _H[0] = (_H[0] + a) | 0;\r\n    _H[1] = (_H[1] + b) | 0;\r\n    _H[2] = (_H[2] + c) | 0;\r\n    _H[3] = (_H[3] + d) | 0;\r\n    _H[4] = (_H[4] + e) | 0;\r\n    _H[5] = (_H[5] + f) | 0;\r\n    _H[6] = (_H[6] + g) | 0;\r\n    _H[7] = (_H[7] + h) | 0;\r\n  }\r\n\r\n  _doFinalize() {\r\n    // Shortcuts\r\n    const data = this._data;\r\n    const dataWords = data.words;\r\n\r\n    const nBitsTotal = this._nDataBytes * 8;\r\n    const nBitsLeft = data.sigBytes * 8;\r\n\r\n    // Add padding\r\n    dataWords[nBitsLeft >>> 5] |= 0x80 << (24 - (nBitsLeft % 32));\r\n    dataWords[(((nBitsLeft + 64) >>> 9) << 4) + 14] = Math.floor(nBitsTotal / 0x100000000);\r\n    dataWords[(((nBitsLeft + 64) >>> 9) << 4) + 15] = nBitsTotal;\r\n    data.sigBytes = dataWords.length * 4;\r\n\r\n    // Hash final blocks\r\n    this._process();\r\n\r\n    // Return final computed hash\r\n    return this._hash;\r\n  }\r\n\r\n  clone() {\r\n    const clone = super.clone.call(this);\r\n    clone._hash = this._hash.clone();\r\n\r\n    return clone;\r\n  }\r\n}\r\n\r\n/**\r\n * Shortcut function to the hasher's object interface.\r\n *\r\n * @param {WordArray|string} message The message to hash.\r\n *\r\n * @return {WordArray} The hash.\r\n *\r\n * @static\r\n *\r\n * @example\r\n *\r\n *     var hash = CryptoJS.SHA256('message');\r\n *     var hash = CryptoJS.SHA256(wordArray);\r\n */\r\nexport const SHA256 = Hasher._createHelper(SHA256Algo);\r\n\r\n/**\r\n * Shortcut function to the HMAC's object interface.\r\n *\r\n * @param {WordArray|string} message The message to hash.\r\n * @param {WordArray|string} key The secret key.\r\n *\r\n * @return {WordArray} The HMAC.\r\n *\r\n * @static\r\n *\r\n * @example\r\n *\r\n *     var hmac = CryptoJS.HmacSHA256(message, key);\r\n */\r\nexport const HmacSHA256 = Hasher._createHmacHelper(SHA256Algo);\r\n"]}