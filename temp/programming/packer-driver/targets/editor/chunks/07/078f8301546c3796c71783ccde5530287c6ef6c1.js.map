{"version":3,"sources":["file:///Volumes/SSD%201/ccProject/extensions/oops-plugin-framework/assets/core/utils/CameraUtil.ts"],"names":["CameraUtil","Vec3","view","isInView","camera","worldPos","cameraPos","node","getWorldPosition","viewPos","worldToScreen","dir","normalize","subtract","forward","dot","viewportRect","getViewportRect","x","width","y","height"],"mappings":";;;8EASaA,U;;;;;;;;;AAHIC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,I,OAAAA,I;;;;;;AANvB;AACA;AACA;AACA;AACA;AACA;;;AAGA;;;4BACaF,U,GAAN,MAAMA,UAAN,CAAiB;AACpB;AACJ;AACA;AACA;AACA;AACmB,eAARG,QAAQ,CAACC,MAAD,EAAiBC,QAAjB,EAAiC;AAC5C,cAAIC,SAAS,GAAGF,MAAM,CAACG,IAAP,CAAYC,gBAAZ,EAAhB;AACA,cAAIC,OAAO,GAAGL,MAAM,CAACM,aAAP,CAAqBL,QAArB,CAAd;AACA,cAAIM,GAAG,GAAGV,IAAI,CAACW,SAAL,CAAe,IAAIX,IAAJ,EAAf,EAA2BI,QAAQ,CAACQ,QAAT,CAAkBP,SAAlB,CAA3B,CAAV;AACA,cAAIQ,OAAO,GAAGV,MAAM,CAACG,IAAP,CAAYO,OAA1B;AACA,cAAIC,GAAG,GAAGd,IAAI,CAACc,GAAL,CAASD,OAAT,EAAkBH,GAAlB,CAAV;AAEA,gBAAMK,YAAY,GAAGd,IAAI,CAACe,eAAL,EAArB,CAP4C,CAS5C;;AACA,cAAIF,GAAG,GAAG,CAAN,CACA;AADA,aAEIN,OAAO,CAACS,CAAR,IAAaF,YAAY,CAACG,KAF9B,IAEyCV,OAAO,CAACS,CAAR,IAAa,CAFtD,IAGIT,OAAO,CAACW,CAAR,IAAaJ,YAAY,CAACK,MAH9B,IAG0CZ,OAAO,CAACW,CAAR,IAAa,CAH3D,EAII,OAAO,IAAP,CAJJ,KAMI,OAAO,KAAP;AACP;;AAvBmB,O","sourcesContent":["/*\r\n * @Author: dgflash\r\n * @Date: 2022-07-26 15:29:57\r\n * @LastEditors: dgflash\r\n * @LastEditTime: 2022-09-02 14:50:16\r\n */\r\nimport { Camera, Vec3, view } from \"cc\";\r\n\r\n/** 摄像机工具 */\r\nexport class CameraUtil {\r\n    /**\r\n     * 当前世界坐标是否在摄像机显示范围内\r\n     * @param camera    摄像机\r\n     * @param worldPos  坐标\r\n     */\r\n    static isInView(camera: Camera, worldPos: Vec3) {\r\n        var cameraPos = camera.node.getWorldPosition();\r\n        var viewPos = camera.worldToScreen(worldPos);\r\n        var dir = Vec3.normalize(new Vec3(), worldPos.subtract(cameraPos));\r\n        var forward = camera.node.forward;\r\n        var dot = Vec3.dot(forward, dir);\r\n\r\n        const viewportRect = view.getViewportRect();\r\n\r\n        // 判断物体是否在相机前面\r\n        if (dot > 0\r\n            // 判断物体是否在视窗内\r\n            && (viewPos.x <= viewportRect.width) && (viewPos.x >= 0)\r\n            && (viewPos.y <= viewportRect.height) && (viewPos.y >= 0))\r\n            return true;\r\n        else\r\n            return false;\r\n    }\r\n}"]}