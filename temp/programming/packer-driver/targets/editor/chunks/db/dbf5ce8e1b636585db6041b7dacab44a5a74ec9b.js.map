{"version":3,"sources":["file:///Volumes/%E5%9B%BA%E6%80%81/ccProject/extensions/oops-plugin-framework/assets/libs/model-view/VMModify.ts"],"names":["Enum","_decorator","VMBase","ccclass","property","menu","help","CLAMP_MODE","VMModify","tooltip","type","visible","valueClamp","valueClampMode","MAX","MIN","clampValue","res","min","valueMin","max","valueMax","MIN_MAX","vAddInt","e","data","vAdd","vSubInt","vSub","vMulInt","vMul","vDivInt","vDiv","int","a","parseFloat","VM","getValue","watchPath","Math","round","setValue","vString","vNumberInt","vNumber"],"mappings":"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","sourcesContent":["import { Enum, _decorator } from 'cc';\r\nimport { VMBase } from './VMBase';\r\n\r\nconst { ccclass, property, menu, help } = _decorator;\r\n\r\n/** 限制值边界范围的模式 */\r\nenum CLAMP_MODE {\r\n    MIN,\r\n    MAX,\r\n    MIN_MAX,\r\n}\r\n\r\n/**\r\n * [VM-Modify]\r\n * 动态快速的修改模型的数值,使用按钮 绑定该组件上的函数，即可动态调用\r\n * 修改 Model 的值\r\n */\r\n@ccclass\r\n@menu('ModelViewer/VM-Modify(修改Model)')\r\n@help('https://gitee.com/dgflash/oops-framework/blob/master/doc/mvvm/VMModify.md')\r\nexport default class VMModify extends VMBase {\r\n    @property({\r\n        tooltip: \"监视对象路径\"\r\n    })\r\n    watchPath: string = \"\";\r\n\r\n    @property({\r\n        tooltip: \"是不启用取值范围限制\"\r\n    })\r\n    valueClamp: boolean = false;\r\n\r\n    @property({\r\n        type: Enum(CLAMP_MODE),\r\n        visible: function () {\r\n            // @ts-ignore\r\n            return this.valueClamp === true;\r\n        }\r\n    })\r\n    valueClampMode: CLAMP_MODE = CLAMP_MODE.MIN_MAX;\r\n\r\n    @property({\r\n        visible: function () {\r\n            // @ts-ignore\r\n            return this.valueClamp === true && this.valueClampMode !== CLAMP_MODE.MAX;\r\n        }\r\n    })\r\n    valueMin: number = 0;\r\n\r\n    @property({\r\n        visible: function () {\r\n            // @ts-ignore\r\n            return this.valueClamp === true && this.valueClampMode !== CLAMP_MODE.MIN;\r\n        }\r\n    })\r\n    valueMax: number = 1;\r\n\r\n    // 限制最终结果的取值范围\r\n    private clampValue(res: number): number {\r\n        let min = this.valueMin;\r\n        let max = this.valueMax;\r\n        if (this.valueClamp == false) return res;\r\n        switch (this.valueClampMode) {\r\n            case CLAMP_MODE.MIN_MAX:\r\n                if (res > max) res = max;\r\n                if (res < min) res = min;\r\n                break;\r\n            case CLAMP_MODE.MIN:\r\n                if (res < min) res = min;\r\n                break;\r\n            case CLAMP_MODE.MAX:\r\n                if (res > max) res = max;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n\r\n        return res;\r\n    }\r\n\r\n    /** 加整数 */\r\n    vAddInt(e: Event, data: string) {\r\n        this.vAdd(e, data, true);\r\n    }\r\n\r\n    /** 减整数 */\r\n    vSubInt(e: Event, data: string) {\r\n        this.vSub(e, data, true);\r\n    }\r\n\r\n    /** 乘整数 */\r\n    vMulInt(e: Event, data: string) {\r\n        this.vMul(e, data, true);\r\n    }\r\n\r\n    /** 除整数 */\r\n    vDivInt(e: Event, data: string) {\r\n        this.vDiv(e, data, true);\r\n    }\r\n\r\n    /** 加 */\r\n    vAdd(e: Event, data: string, int: boolean = false) {\r\n        let a = parseFloat(data);\r\n        let res = this.VM.getValue(this.watchPath, 0) + a;\r\n        if (int) { res = Math.round(res) }\r\n        this.VM.setValue(this.watchPath, this.clampValue(res));\r\n    }\r\n\r\n    /** 减 */\r\n    vSub(e: Event, data: string, int: boolean = false) {\r\n        let a = parseFloat(data);\r\n        let res = this.VM.getValue(this.watchPath, 0) - a;\r\n        if (int) { res = Math.round(res) }\r\n        this.VM.setValue(this.watchPath, this.clampValue(res));\r\n    }\r\n\r\n    /** 乘 */\r\n    vMul(e: Event, data: string, int: boolean = false) {\r\n        let a = parseFloat(data);\r\n        let res = this.VM.getValue(this.watchPath, 0) * a;\r\n        if (int) { res = Math.round(res) }\r\n        this.VM.setValue(this.watchPath, this.clampValue(res));\r\n    }\r\n\r\n    /** 除 */\r\n    vDiv(e: Event, data: string, int: boolean = false) {\r\n        let a = parseFloat(data);\r\n        let res = this.VM.getValue(this.watchPath, 0) / a;\r\n        if (int) { res = Math.round(res) }\r\n        this.VM.setValue(this.watchPath, this.clampValue(res));\r\n    }\r\n\r\n    /** 字符串赋值 */\r\n    vString(e: Event, data: string) {\r\n        let a = data;\r\n        this.VM.setValue(this.watchPath, a);\r\n    }\r\n\r\n    /** 整数赋值 */\r\n    vNumberInt(e: Event, data: string) {\r\n        this.vNumber(e, data, true);\r\n    }\r\n\r\n    /** 数字赋值 */\r\n    vNumber(e: Event, data: string, int: boolean = false) {\r\n        let a = parseFloat(data);\r\n        if (int) { a = Math.round(a) }\r\n        this.VM.setValue(this.watchPath, this.clampValue(a));\r\n    }\r\n}\r\n"]}