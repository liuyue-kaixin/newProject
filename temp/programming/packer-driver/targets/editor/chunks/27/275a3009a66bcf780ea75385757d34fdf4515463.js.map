{"version":3,"sources":["file:///Volumes/SSD%201/ccProject/node_modules/crypto-es/lib/evpkdf.js"],"names":["EvpKDFAlgo","Base","WordArray","MD5Algo","constructor","cfg","Object","assign","keySize","hasher","iterations","compute","password","salt","block","create","derivedKey","derivedKeyWords","words","length","update","finalize","reset","i","concat","sigBytes","EvpKDF"],"mappings":";;;gCAUaA,U;;;;;;AATXC,MAAAA,I,gBAAAA,I;AACAC,MAAAA,S,gBAAAA,S;;AAEOC,MAAAA,O,iBAAAA,O;;;AAET;AACA;AACA;AACA;4BACaH,U,GAAN,MAAMA,UAAN,SAAyBC,IAAzB,CAA8B;AACnC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACEG,QAAAA,WAAW,CAACC,GAAD,EAAM;AACf;AAEA;AACJ;AACA;AACA;AACA;AACA;AACA;;AACI,eAAKA,GAAL,GAAWC,MAAM,CAACC,MAAP,CACT,IAAIN,IAAJ,EADS,EAET;AACEO,YAAAA,OAAO,EAAE,MAAM,EADjB;AAEEC,YAAAA,MAAM,EAAEN,OAFV;AAGEO,YAAAA,UAAU,EAAE;AAHd,WAFS,EAOTL,GAPS,CAAX;AASD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACEM,QAAAA,OAAO,CAACC,QAAD,EAAWC,IAAX,EAAiB;AACtB,cAAIC,KAAJ,CADsB,CAGtB;;AACA,gBAAM;AAAET,YAAAA;AAAF,cAAU,IAAhB,CAJsB,CAMtB;;AACA,gBAAMI,MAAM,GAAGJ,GAAG,CAACI,MAAJ,CAAWM,MAAX,EAAf,CAPsB,CAStB;;AACA,gBAAMC,UAAU,GAAGd,SAAS,CAACa,MAAV,EAAnB,CAVsB,CAYtB;;AACA,gBAAME,eAAe,GAAGD,UAAU,CAACE,KAAnC;AACA,gBAAM;AAAEV,YAAAA,OAAF;AAAWE,YAAAA;AAAX,cAA0BL,GAAhC,CAdsB,CAgBtB;;AACA,iBAAOY,eAAe,CAACE,MAAhB,GAAyBX,OAAhC,EAAyC;AACvC,gBAAIM,KAAJ,EAAW;AACTL,cAAAA,MAAM,CAACW,MAAP,CAAcN,KAAd;AACD;;AACDA,YAAAA,KAAK,GAAGL,MAAM,CAACW,MAAP,CAAcR,QAAd,EAAwBS,QAAxB,CAAiCR,IAAjC,CAAR;AACAJ,YAAAA,MAAM,CAACa,KAAP,GALuC,CAOvC;;AACA,iBAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGb,UAApB,EAAgCa,CAAC,IAAI,CAArC,EAAwC;AACtCT,cAAAA,KAAK,GAAGL,MAAM,CAACY,QAAP,CAAgBP,KAAhB,CAAR;AACAL,cAAAA,MAAM,CAACa,KAAP;AACD;;AAEDN,YAAAA,UAAU,CAACQ,MAAX,CAAkBV,KAAlB;AACD;;AACDE,UAAAA,UAAU,CAACS,QAAX,GAAsBjB,OAAO,GAAG,CAAhC;AAEA,iBAAOQ,UAAP;AACD;;AAhFkC,O;AAmFrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;wBACaU,M,GAAS,CAACd,QAAD,EAAWC,IAAX,EAAiBR,GAAjB,KAAyBL,UAAU,CAACe,MAAX,CAAkBV,GAAlB,EAAuBM,OAAvB,CAA+BC,QAA/B,EAAyCC,IAAzC,C","sourcesContent":["import {\r\n  Base,\r\n  WordArray,\r\n} from './core.js';\r\nimport { MD5Algo } from './md5.js';\r\n\r\n/**\r\n * This key derivation function is meant to conform with EVP_BytesToKey.\r\n * www.openssl.org/docs/crypto/EVP_BytesToKey.html\r\n */\r\nexport class EvpKDFAlgo extends Base {\r\n  /**\r\n   * Initializes a newly created key derivation function.\r\n   *\r\n   * @param {Object} cfg (Optional) The configuration options to use for the derivation.\r\n   *\r\n   * @example\r\n   *\r\n   *     const kdf = CryptoJS.algo.EvpKDF.create();\r\n   *     const kdf = CryptoJS.algo.EvpKDF.create({ keySize: 8 });\r\n   *     const kdf = CryptoJS.algo.EvpKDF.create({ keySize: 8, iterations: 1000 });\r\n   */\r\n  constructor(cfg) {\r\n    super();\r\n\r\n    /**\r\n     * Configuration options.\r\n     *\r\n     * @property {number} keySize The key size in words to generate. Default: 4 (128 bits)\r\n     * @property {Hasher} hasher The hash algorithm to use. Default: MD5\r\n     * @property {number} iterations The number of iterations to perform. Default: 1\r\n     */\r\n    this.cfg = Object.assign(\r\n      new Base(),\r\n      {\r\n        keySize: 128 / 32,\r\n        hasher: MD5Algo,\r\n        iterations: 1,\r\n      },\r\n      cfg,\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Derives a key from a password.\r\n   *\r\n   * @param {WordArray|string} password The password.\r\n   * @param {WordArray|string} salt A salt.\r\n   *\r\n   * @return {WordArray} The derived key.\r\n   *\r\n   * @example\r\n   *\r\n   *     const key = kdf.compute(password, salt);\r\n   */\r\n  compute(password, salt) {\r\n    let block;\r\n\r\n    // Shortcut\r\n    const { cfg } = this;\r\n\r\n    // Init hasher\r\n    const hasher = cfg.hasher.create();\r\n\r\n    // Initial values\r\n    const derivedKey = WordArray.create();\r\n\r\n    // Shortcuts\r\n    const derivedKeyWords = derivedKey.words;\r\n    const { keySize, iterations } = cfg;\r\n\r\n    // Generate key\r\n    while (derivedKeyWords.length < keySize) {\r\n      if (block) {\r\n        hasher.update(block);\r\n      }\r\n      block = hasher.update(password).finalize(salt);\r\n      hasher.reset();\r\n\r\n      // Iterations\r\n      for (let i = 1; i < iterations; i += 1) {\r\n        block = hasher.finalize(block);\r\n        hasher.reset();\r\n      }\r\n\r\n      derivedKey.concat(block);\r\n    }\r\n    derivedKey.sigBytes = keySize * 4;\r\n\r\n    return derivedKey;\r\n  }\r\n}\r\n\r\n/**\r\n * Derives a key from a password.\r\n *\r\n * @param {WordArray|string} password The password.\r\n * @param {WordArray|string} salt A salt.\r\n * @param {Object} cfg (Optional) The configuration options to use for this computation.\r\n *\r\n * @return {WordArray} The derived key.\r\n *\r\n * @static\r\n *\r\n * @example\r\n *\r\n *     var key = CryptoJS.EvpKDF(password, salt);\r\n *     var key = CryptoJS.EvpKDF(password, salt, { keySize: 8 });\r\n *     var key = CryptoJS.EvpKDF(password, salt, { keySize: 8, iterations: 1000 });\r\n */\r\nexport const EvpKDF = (password, salt, cfg) => EvpKDFAlgo.create(cfg).compute(password, salt);\r\n"]}