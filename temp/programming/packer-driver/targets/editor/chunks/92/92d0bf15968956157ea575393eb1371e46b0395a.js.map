{"version":3,"sources":["file:///Volumes/SSD/ccProject/extensions/oops-plugin-framework/assets/libs/animator-effect/2d/SpineFinishedRelease.ts"],"names":["Component","sp","_decorator","oops","ccclass","property","SpineFinishedRelease","spine","resPath","setResPath","path","onLoad","getComponent","Skeleton","setCompleteListener","onSpineComplete","bind","res","load","SkeletonData","err","sd","console","error","skeletonData","setAnimation","isDestroy","node","destroy","removeFromParent"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAOSA,MAAAA,S,OAAAA,S;AAAWC,MAAAA,E,OAAAA,E;AAAIC,MAAAA,U,OAAAA,U;;AACfC,MAAAA,I,iBAAAA,I;;;;;;AART;AACA;AACA;AACA;AACA;AACA;;;;;OAIM;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBH,U;AAE9B;;sCAEaI,oB,WADZF,OAAO,CAAC,sBAAD,C,2BAAR,MACaE,oBADb,SAC0CN,SAD1C,CACoD;AAAA;AAAA;;AAAA;;AAAA,eAIxCO,KAJwC;AAAA,eAKxCC,OALwC,GAKtB,IALsB;AAAA;;AAOhD;AACAC,QAAAA,UAAU,CAACC,IAAD,EAAe;AACrB,eAAKF,OAAL,GAAeE,IAAf;AACH;;AAEDC,QAAAA,MAAM,GAAG;AACL,eAAKJ,KAAL,GAAa,KAAKK,YAAL,CAAkBX,EAAE,CAACY,QAArB,CAAb;AACA,eAAKN,KAAL,CAAWO,mBAAX,CAA+B,KAAKC,eAAL,CAAqBC,IAArB,CAA0B,IAA1B,CAA/B;;AAEA,cAAI,KAAKR,OAAT,EAAkB;AACd;AAAA;AAAA,8BAAKS,GAAL,CAASC,IAAT,CAAc,KAAKV,OAAnB,EAA4BP,EAAE,CAACkB,YAA/B,EAA6C,CAACC,GAAD,EAAoBC,EAApB,KAA4C;AACrF,kBAAID,GAAJ,EAAS;AACLE,gBAAAA,OAAO,CAACC,KAAR,CAAe,MAAK,KAAKf,OAAQ,gBAAjC;AACA;AACH;;AAED,mBAAKD,KAAL,CAAWiB,YAAX,GAA0BH,EAA1B;AACA,mBAAKd,KAAL,CAAWkB,YAAX,CAAwB,CAAxB,EAA2B,WAA3B,EAAwC,KAAxC;AACH,aARD;AASH,WAVD,MAWK;AACD,iBAAKlB,KAAL,CAAWkB,YAAX,CAAwB,CAAxB,EAA2B,WAA3B,EAAwC,KAAxC;AACH;AACJ;;AAEOV,QAAAA,eAAe,GAAG;AACtB,cAAI,KAAKW,SAAT,EAAoB;AAChB,iBAAKC,IAAL,CAAUC,OAAV;AACH,WAFD,MAGK;AACD,iBAAKD,IAAL,CAAUE,gBAAV;AACH;AACJ;;AAvC+C,O,4EAC/CxB,Q;;;;;iBACoB,I","sourcesContent":["/*\r\n * @Author: dgflash\r\n * @Date: 2021-10-12 14:11:04\r\n * @LastEditors: dgflash\r\n * @LastEditTime: 2022-04-08 15:42:16\r\n */\r\n\r\nimport { Component, sp, _decorator } from 'cc';\r\nimport { oops } from '../../../core/Oops';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/** 动画播放完隐藏特效 */\r\n@ccclass('SpineFinishedRelease')\r\nexport class SpineFinishedRelease extends Component {\r\n    @property\r\n    isDestroy: boolean = true;\r\n\r\n    private spine!: sp.Skeleton;\r\n    private resPath: string = null!;\r\n\r\n    /** 设置路径 */\r\n    setResPath(path: string) {\r\n        this.resPath = path;\r\n    }\r\n\r\n    onLoad() {\r\n        this.spine = this.getComponent(sp.Skeleton)!;\r\n        this.spine.setCompleteListener(this.onSpineComplete.bind(this));\r\n\r\n        if (this.resPath) {\r\n            oops.res.load(this.resPath, sp.SkeletonData, (err: Error | null, sd: sp.SkeletonData) => {\r\n                if (err) {\r\n                    console.error(`加载【${this.resPath}】的 SPINE 资源不存在`);\r\n                    return;\r\n                }\r\n\r\n                this.spine.skeletonData = sd;\r\n                this.spine.setAnimation(0, \"animation\", false);\r\n            });\r\n        }\r\n        else {\r\n            this.spine.setAnimation(0, \"animation\", false);\r\n        }\r\n    }\r\n\r\n    private onSpineComplete() {\r\n        if (this.isDestroy) {\r\n            this.node.destroy();\r\n        }\r\n        else {\r\n            this.node.removeFromParent();\r\n        }\r\n    }\r\n}\r\n"]}